### **形式系统 $\mathcal{L}$**

#### **1. 形式语言 (Formal Language)**

形式系统 $\mathcal{L}$ 的语言由其字母表和良构公式的构成规则定义。

##### **1.1. 字母表 (Alphabet)**

1.  **公式变量 (Formula Variables):**
    一个可数的集合，以小写希腊字母表示：
    $\phi, \psi, \omega, \dots$

2.  **逻辑算子 (Logical Operators):**
    *   一元算子 (Unary Operator): $Q(\cdot)$
    *   二元算子 (Binary Operators): $D(\cdot, \cdot)$, $P(\cdot, \cdot)$

3.  **辅助符号 (Auxiliary Symbols):**
    `(` , `)`

##### **1.2. 良构公式 (Well-Formed Formulas - WFFs)**

良构公式（WFF）的集合是满足以下条件的最小集合：

1.  **基础条款 (Base Clause):**
    任何公式变量 $\phi$ 都是一个WFF。

2.  **归纳条款 (Inductive Clause):**
    *   若 $\phi$ 是一个WFF，则 $Q(\phi)$ 是一个WFF。
    *   若 $\phi$ 和 $\psi$ 都是WFF，则 $D(\phi, \psi)$ 是一个WFF。
    *   若 $\phi$ 和 $\psi$ 都是WFF，则 $P(\phi, \psi)$ 是一个WFF。

3.  **封闭条款 (Closure Clause):**
    只有通过有限次应用上述基础条款和归纳条款生成的表达式才是WFF。

#### **2. 公理与规则 (Axioms and Rules)**

本系统包含一个公理模式和两条推理规则。我们使用符号 $\vdash$ 表示“可证”。

##### **2.1. 公理模式 (Axiom Schema)**

*   **AS1: 同一性 (Identity)**

    对于任意一个WFF $\phi$，以下公式是一个公理：
    $$
    \vdash D(\phi, \phi)
    $$

##### **2.2. 推理规则 (Inference Rules)**

令 $\Gamma$ 为一个WFF的集合，$\psi$ 为一个WFF。$\Gamma \vdash \psi$ 表示可以从前提集合 $\Gamma$ 中推导出结论 $\psi$。
若 $\phi$, $\psi$, $\omega$, $\chi$ 均为WFF，则适用以下规则：

*   **R1: 提问-断言转换 (Question-Assertion Transformation)**
	$$
    \{ Q(P(\psi, Q(\phi))) \} \vdash D(\psi, \phi)
    $$

*   **R2: 问题重构 (Problem Restructuring)**
	$$
    \{ Q(P(Q(\psi), \phi)), D(Q(\phi), \omega) \} \vdash D(\phi, P(\psi, \omega))
    $$

*   **R3: 问题单射 (Question Injectivity)**
    $$ \{ D(Q(\phi), Q(\psi)) \} \vdash D(\phi, \psi) $$

*   **R4: 定义反射 (Definitional Reflection)**
    $$ \{ Q(Q(\phi)), D(\phi, \psi) \} \vdash D(D(\phi, \psi), Q(\phi)) $$

*   **R5: 传递性 (Transitivity)**
    $$ \{ D(\phi, \psi), D(\psi, \omega) \} \vdash D(\phi, \omega) $$

*   **R6: 定义一致性1 (Definitional Congruence1)**
    $$ \{ D(\phi, \psi) \} \vdash D(Q(\phi), Q(\psi)) $$

*   **R7:定义一致性2 (Definitional Congruence 2)**
    $$
    \{D(\varphi, \psi)\}⊢ D(P(\varphi, \chi),P(\psi, \chi))
    $$

---

### **3. 模型论语义 (Model-Theoretic Semantics)**

#### **3.1. 结构与释义 (Structure and Interpretation)**

为形式系统 $\mathcal{L}$ 提供语义，我们定义一个模型结构 $\mathcal{M}$。

##### **3.1.1. 语义域 (Semantic Domain)**

1.  **世界集 (Set of Worlds):** $W := \mathbb{Z}$ (整数集)。
2.  **真值集 (Set of Truth-Values):** $B := \{0, 1\}$。
3.  **语义值空间 (Space of Semantic Values):** $\mathcal{V} := \{f \mid f: W \to B\}$。此空间由所有从世界集到真值集的函数构成。

##### **3.1.2. 赋值函数 (Valuation Function)**

一个赋值 $v$ 是一个函数，它将每个公式变量映射到语义值空间中的一个元素：
$$
v: \text{FormulaVariables} \to \mathcal{V}
$$
此函数 $v$ 通过以下规则递归地扩展至所有良构公式（WFF）：

##### **3.1.3. 算子的语义释义 (Semantic Interpretation of Operators)**

对于任意 WFF $\phi, \psi$，以及任意赋值 $v$，设 $v(\phi) = f \in \mathcal{V}$ 且 $v(\psi) = g \in \mathcal{V}$。

1.  **算子 $Q(\cdot)$:** $v(Q(\phi))$ 是 $\mathcal{V}$ 中由下式定义的函数：
    $$
    \forall w \in W, \quad [v(Q(\phi))](w) := f(w+1)
    $$

2.  **算子 $D(\cdot, \cdot)$:** $v(D(\phi, \psi))$ 是 $\mathcal{V}$ 中由下式定义的函数：
    $$
    \forall w \in W, \quad [v(D(\phi, \psi))](w) := \begin{cases} 1 & \text{if } f(w) = g(w) \\ 0 & \text{otherwise} \end{cases}
    $$

3.  **算子 $P(\cdot, \cdot)$:** $v(P(\phi, \psi))$ 是 $\mathcal{V}$ 中由下式定义的函数：
    $$
    \forall w \in W, \quad [v(P(\phi, \psi))](w) := f(w) \land g(w-1)
    $$
    其中 $\land$ 是标准布尔合取 ($1 \land 1 = 1$，其他情况为 $0$)。

##### **3.1.4. 满足、有效性与语义后承 (Satisfaction, Validity, and Semantic Consequence)**

1.  **满足 (Satisfaction):** 一个赋值 $v$ **满足**一个 WFF $\phi$，记作 $v \models_{\mathcal{M}} \phi$，当且仅当 $v(\phi)$ 是常数函数 $1$。
    $$
    v \models_{\mathcal{M}} \phi \quad \iff \quad \forall w \in W, [v(\phi)](w) = 1
    $$

2.  **有效性 (Validity):** 一个 WFF $\phi$ 在模型 $\mathcal{M}$ 中是**有效的**，记作 $\models_{\mathcal{M}} \phi$，当且仅当对于所有赋值 $v$，$v$ 都满足 $\phi$。
    $$
    \models_{\mathcal{M}} \phi \quad \iff \quad \forall v, v \models_{\mathcal{M}} \phi
    $$

3.  **语义后承 (Semantic Consequence):** 一个 WFF 集合 $\Gamma$ **语义蕴涵**一个 WFF $\psi$，记作 $\Gamma \models_{\mathcal{M}} \psi$，当且仅当对于所有赋值 $v$，如果 $v$ 满足 $\Gamma$ 中的每一个公式，那么 $v$ 也满足 $\psi$。
    $$
    \Gamma \models_{\mathcal{M}} \psi \quad \iff \quad \forall v, \left( (\forall \gamma \in \Gamma, v \models_{\mathcal{M}} \gamma) \implies v \models_{\mathcal{M}} \psi \right)
    $$

#### **3.2. 系统 $\mathcal{L}$ 的可靠性 (Soundness of System $\mathcal{L}$)**

**定理：** 系统 $\mathcal{L}$ 相对于模型 $\mathcal{M}$ 是可靠的 (sound)。

此定理意为：
1.  所有由公理模式 AS1 生成的公理都是有效的。
2.  所有推理规则 R1-R7 都是可靠的，即对于每条规则 $\{\Gamma\} \vdash \psi$，都有 $\Gamma \models_{\mathcal{M}} \psi$。

**证明：**

##### **3.2.1. 公理模式的有效性**

*   **AS1: $\vdash D(\phi, \phi)$**
    1.  需证 $\models_{\mathcal{M}} D(\phi, \phi)$。
    2.  根据有效性定义，需证对于任意赋值 $v$，$v \models_{\mathcal{M}} D(\phi, \phi)$。
    3.  设 $v$ 为任意赋值，令 $v(\phi) = f$。
    4.  根据满足的定义，需证 $\forall w \in W, [v(D(\phi, \phi))](w) = 1$。
    5.  根据 $D$ 的语义释义，$[v(D(\phi, \phi))](w) = 1 \iff f(w) = f(w)$。
    6.  根据等价关系的自反性，$f(w) = f(w)$ 对于所有 $w \in W$ 恒成立。
    7.  因此，$\forall w \in W, [v(D(\phi, \phi))](w) = 1$。
    8.  由于 $v$ 是任意的，故 $\models_{\mathcal{M}} D(\phi, \phi)$。

##### **3.2.2. 推理规则的可靠性**

对于每条规则，我们证明其前提语义蕴涵其结论。设 $v(\phi)=f, v(\psi)=g, v(\omega)=h, v(\chi)=k$。

*   **R1: $\{ Q(P(\psi, Q(\phi))) \} \models_{\mathcal{M}} D(\psi, \phi)$**
    1.  设 $v$ 为任意赋值。假设 $v \models_{\mathcal{M}} Q(P(\psi, Q(\phi)))$。
    2.  这意味着 $\forall w \in W, [v(Q(P(\psi, Q(\phi))))](w) = 1$。
    3.  根据 $Q$ 的释义，这等价于 $\forall w \in W, [v(P(\psi, Q(\phi)))](w+1) = 1$。
    4.  根据 $P$ 的释义，这等价于 $\forall w \in W, [v(\psi)](w+1) \land [v(Q(\phi))]((w+1)-1) = 1$。
    5.  化简得 $\forall w \in W, g(w+1) \land [v(Q(\phi))](w) = 1$。
    6.  根据 $Q$ 的释义，这等价于 $\forall w \in W, g(w+1) \land f(w+1) = 1$。
    7.  根据 $\land$ 的定义，此式成立当且仅当 $\forall w \in W, g(w+1)=1$ 且 $f(w+1)=1$。
    8.  由于 $w$ 遍历 $\mathbb{Z}$，$w+1$ 也遍历 $\mathbb{Z}$。因此，$f$ 和 $g$ 必须是常数函数 $1$。
    9.  需证 $v \models_{\mathcal{M}} D(\psi, \phi)$，即 $\forall w \in W, [v(D(\psi, \phi))](w) = 1$。
    10. 根据 $D$ 的释义，这要求 $\forall w \in W, g(w) = f(w)$。
    11. 由步骤 (8) 知，$g(w)=1$ 且 $f(w)=1$ 对所有 $w \in W$ 成立，故 $g(w)=f(w)$ 成立。
    12. 由于 $v$ 是任意的，因此该规则可靠。

*   **R2: $\{ Q(P(Q(\psi), \phi)), D(Q(\phi), \omega) \} \models_{\mathcal{M}} D(\phi, P(\psi, \omega))$**
    1.  设 $v$ 为任意赋值。假设 $v \models_{\mathcal{M}} Q(P(Q(\psi), \phi))$ 且 $v \models_{\mathcal{M}} D(Q(\phi), \omega)$。
    2.  从 $v \models_{\mathcal{M}} Q(P(Q(\psi), \phi))$: $\forall w \in W, [v(Q(P(Q(\psi), \phi)))] (w) = 1$。
    3.  展开得 $\forall w \in W, [v(Q(\psi))](w+1) \land f(w) = 1$，即 $\forall w \in W, g(w+2) \land f(w) = 1$。
    4.  这蕴涵了 $\forall z \in \mathbb{Z}, g(z)=1$ 且 $\forall z \in \mathbb{Z}, f(z)=1$。
    5.  从 $v \models_{\mathcal{M}} D(Q(\phi), \omega)$: $\forall w \in W, [v(D(Q(\phi), \omega))](w) = 1$。
    6.  这蕴涵了 $\forall w \in W, [v(Q(\phi))](w) = h(w)$，即 $\forall w \in W, f(w+1) = h(w)$。
    7.  由步骤 (4) 知 $f$ 是常数函数 $1$，故 $f(w+1)=1$。因此 $\forall w \in W, h(w)=1$。
    8.  需证 $v \models_{\mathcal{M}} D(\phi, P(\psi, \omega))$，即 $\forall w \in W, f(w) = [v(P(\psi, \omega))](w)$。
    9.  根据 $P$ 的释义，这要求 $\forall w \in W, f(w) = g(w) \land h(w-1)$。
    10. 将步骤 (4) 和 (7) 的结果代入右侧：$1 \land 1 = 1$。左侧 $f(w)=1$。等式 $1=1$ 成立。
    11. 由于 $v$ 是任意的，因此该规则可靠。

*   **R3: $\{ D(Q(\phi), Q(\psi)) \} \models_{\mathcal{M}} D(\phi, \psi)$**
    1.  设 $v$ 为任意赋值。假设 $v \models_{\mathcal{M}} D(Q(\phi), Q(\psi))$。
    2.  这意味着 $\forall w \in W, [v(D(Q(\phi), Q(\psi)))](w) = 1$。
    3.  根据 $D$ 的释义，$\forall w \in W, [v(Q(\phi))](w) = [v(Q(\psi))](w)$。
    4.  根据 $Q$ 的释义，$\forall w \in W, f(w+1) = g(w+1)$。
    5.  由于 $w$ 遍历 $\mathbb{Z}$，$w+1$ 也遍历 $\mathbb{Z}$。这表明函数 $f$ 和 $g$ 是同一函数，即 $f=g$。
    6.  需证 $v \models_{\mathcal{M}} D(\phi, \psi)$，即 $\forall w \in W, [v(D(\phi, \psi))](w) = 1$。
    7.  这要求 $\forall w \in W, f(w) = g(w)$，此由步骤 (5) 直接保证。
    8.  由于 $v$ 是任意的，因此该规则可靠。

*   **R4: $\{ Q(Q(\phi)), D(\phi, \psi) \} \models_{\mathcal{M}} D(D(\phi, \psi), Q(\phi))$**
    1.  设 $v$ 为任意赋值。假设 $v \models_{\mathcal{M}} Q(Q(\phi))$ 且 $v \models_{\mathcal{M}} D(\phi, \psi)$。
    2.  从 $v \models_{\mathcal{M}} Q(Q(\phi))$: $\forall w \in W, [v(Q(Q(\phi)))] (w) = 1$。
    3.  展开得 $\forall w \in W, [v(Q(\phi))](w+1) = 1$，即 $\forall w \in W, f(w+2) = 1$。这蕴涵 $f$ 是常数函数 $1$。
    4.  从 $v \models_{\mathcal{M}} D(\phi, \psi)$: $\forall w \in W, [v(D(\phi, \psi))](w) = 1$。
    5.  这蕴涵 $\forall w \in W, f(w) = g(w)$。
    6.  结合 (3) 和 (5) 可知，$g$ 也是常数函数 $1$。
    7.  需证 $v \models_{\mathcal{M}} D(D(\phi, \psi), Q(\phi))$，即 $\forall w \in W, [v(D(\phi, \psi))](w) = [v(Q(\phi))](w)$。
    8.  左侧 (LHS): 由前提假设 (4)，$\forall w \in W, [v(D(\phi, \psi))](w) = 1$。
    9.  右侧 (RHS): $\forall w \in W, [v(Q(\phi))](w) = f(w+1)$。由 (3) 知 $f$ 是常数函数 $1$，故 $f(w+1)=1$。
    10. LHS = RHS (1=1) 成立。
    11. 由于 $v$ 是任意的，因此该规则可靠。

*   **R5: $\{ D(\phi, \psi), D(\psi, \omega) \} \models_{\mathcal{M}} D(\phi, \omega)$**
    1.  设 $v$ 为任意赋值。假设 $v \models_{\mathcal{M}} D(\phi, \psi)$ 且 $v \models_{\mathcal{M}} D(\psi, \omega)$。
    2.  这蕴涵 $\forall w \in W, f(w) = g(w)$ 且 $\forall w \in W, g(w) = h(w)$。
    3.  根据等价关系的传递性，$\forall w \in W, f(w) = h(w)$。
    4.  需证 $v \models_{\mathcal{M}} D(\phi, \omega)$，即 $\forall w \in W, f(w) = h(w)$。
    5.  此结论已在步骤 (3) 中证得。
    6.  由于 $v$ 是任意的，因此该规则可靠。

*   **R6: $\{ D(\phi, \psi) \} \models_{\mathcal{M}} D(Q(\phi), Q(\psi))$**
    1.  设 $v$ 为任意赋值。假设 $v \models_{\mathcal{M}} D(\phi, \psi)$。
    2.  这意味着 $\forall w \in W, f(w) = g(w)$，即 $f=g$。
    3.  需证 $v \models_{\mathcal{M}} D(Q(\phi), Q(\psi))$，即 $\forall w \in W, [v(Q(\phi))](w) = [v(Q(\psi))](w)$。
    4.  根据 $Q$ 的释义，这要求 $\forall w \in W, f(w+1) = g(w+1)$。
    5.  由于 $f=g$，该等式对于任何参数均成立，包括 $w+1$。
    6.  由于 $v$ 是任意的，因此该规则可靠。

*   **R7: $\{ D(\phi, \psi) \} \models_{\mathcal{M}} D(P(\phi, \chi),P(\psi, \chi))$**
    1.  设 $v$ 为任意赋值。假设 $v \models_{\mathcal{M}} D(\phi, \psi)$。
    2.  这意味着 $\forall w \in W, f(w) = g(w)$。
    3.  需证 $v \models_{\mathcal{M}} D(P(\phi, \chi),P(\psi, \chi))$，即 $\forall w \in W, [v(P(\phi, \chi))](w) = [v(P(\psi, \chi))](w)$。
    4.  左侧 (LHS): $[v(P(\phi, \chi))](w) = f(w) \land k(w-1)$。
    5.  右侧 (RHS): $[v(P(\psi, \chi))](w) = g(w) \land k(w-1)$。
    6.  由步骤 (2) 知 $f(w) = g(w)$，故 LHS = RHS。
    7.  由于 $v$ 是任意的，因此该规则可靠。

所有公理模式和推理规则均已证毕，故系统 $\mathcal{L}$ 的可靠性得证。

#### **3.3. 模型的性质 (Properties of the Model)**

*   **非平凡性 (Non-triviality):** 模型 $\mathcal{M}$ 是非平凡的，意为存在一个 WFF $\phi$，使得 $\not\models_{\mathcal{M}} \phi$。
    1.  **证明:**
    2.  考虑公式变量 $\phi$。
    3.  构造一个赋值 $v$ 使得 $v(\phi)=f$，其中 $f$ 定义为 $f(w) := w \pmod 2$。
    4.  则 $[v(\phi)](0) = 0$ 且 $[v(\phi)](1) = 1$。
    5.  由于 $v(\phi)$ 不是常数函数 $1$，故 $v \not\models_{\mathcal{M}} \phi$。
    6.  因此，根据有效性的定义，$\not\models_{\mathcal{M}} \phi$。模型是非平凡的。

*   **非退化性 (Non-degeneracy):** 模型 $\mathcal{M}$ 是非退化的，意为对于每条推理规则 $\{\Gamma\} \vdash \psi$，存在一个赋值 $v$ 使得 $v \models_{\mathcal{M}} \gamma$ 对所有 $\gamma \in \Gamma$ 成立。这确保了规则的可靠性不是空虚为真 (vacuously true) 的。
    1.  **证明:**
    2.  定义常数函数 $1_{\mathcal{V}} \in \mathcal{V}$ 为: $\forall w \in W, 1_{\mathcal{V}}(w) = 1$。
    3.  构造一个赋值 $v_1$，使得对于所有公式变量 $\alpha$，都有 $v_1(\alpha) = 1_{\mathcal{V}}$。易证，对于任何由这些变量构成的 WFF $\beta$，$v_1(\beta)$ 也是 $1_{\mathcal{V}}$。
    4.  我们验证 $v_1$ 满足所有规则的前提：
        *   **R1:** $v_1 \models_{\mathcal{M}} Q(P(\psi, Q(\phi)))$，因为 $v_1$ 将所有 WFF 映射到 $1_{\mathcal{V}}$。
        *   **R2:** $v_1 \models_{\mathcal{M}} Q(P(Q(\psi), \phi))$ 且 $v_1 \models_{\mathcal{M}} D(Q(\phi), \omega)$。
        *   **R3:** $v_1 \models_{\mathcal{M}} D(Q(\phi), Q(\psi))$。
        *   **R4:** $v_1 \models_{\mathcal{M}} Q(Q(\phi))$ 且 $v_1 \models_{\mathcal{M}} D(\phi, \psi)$。
        *   **R5:** $v_1 \models_{\mathcal{M}} D(\phi, \psi)$ 且 $v_1 \models_{\mathcal{M}} D(\psi, \omega)$。
        *   **R6 & R7:** $v_1 \models_{\mathcal{M}} D(\phi, \psi)$。
    5.  由于对每条规则的前提，都存在至少一个赋值（如 $v_1$）满足它们，因此模型是非退化的。
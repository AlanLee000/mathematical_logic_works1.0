### **受限扩张系统 (System $\mathcal{L}_{\nabla}$)**

#### **1. 语法 (Syntax)**

定义两个互不相交的可数无限原子集合：
*   **基础原子集 (Base Atoms)**: $\mathbb{P} = \{ p_0, p_1, p_2, \dots \}$
*   **扩张原子集 (Expansion Atoms)**: $\mathbb{X} = \{ x_0, x_1, x_2, \dots \}$
    *   *注：$\mathbb{X}$ 中的元素是有序的，用于模拟证明过程中新原子的引入顺序。*

公式集合 $\Phi$ 通过以下巴科斯-诺尔范式 (BNF) 归纳定义：

$$ \varphi, \psi ::= p \mid \bot \mid (\varphi \to \psi) \mid \nabla \varphi $$

其中 $p \in \mathbb{P}$。标准逻辑连接词定义为简写：
*   $\neg \varphi \equiv \varphi \to \bot$
*   $\varphi \land \psi \equiv \neg(\varphi \to \neg \psi)$
*   $\varphi \lor \psi \equiv \neg \varphi \to \psi$

---

#### **2. 语义结构 (Semantic Structure)**

**定义 2.1（模型）**
一个模型 $\mathcal{M}$ 是一个从所有原子（基础和扩张）到真值的映射函数：
$$ \mathcal{M} : (\mathbb{P} \cup \mathbb{X}) \to \{0, 1\} $$

**定义 2.2（扩张状态）**
一个状态由一个自然数 $k \in \mathbb{N}$ 表示。
*   $k$ 代表当前已经消耗的扩张原子的数量（即“高水位线”）。
*   在状态 $k$ 下，下一个可用的新鲜原子是 $x_k \in \mathbb{X}$。

---

#### **3. 评估规则 (Evaluation Rules)**

由于算子 $\nabla$ 具有修改语义集的副作用，公式的真值评估不再是静态的，而是一个从**输入状态**到**输出状态**的变换过程。

定义评估函数 $\mathcal{E}$，接受一个模型 $\mathcal{M}$、一个公式 $\varphi$ 和一个当前状态 $k$，返回一个二元组 $(v, k')$，其中 $v \in \{0, 1\}$ 是真值，$k'$ 是评估后的新状态。

$$ \mathcal{E}^\mathcal{M} : \Phi \times \mathbb{N} \to \{0, 1\} \times \mathbb{N} $$

$\mathcal{E}^\mathcal{M}(\varphi, k)$ 的归纳定义如下：

1.  **基础原子 ($p$)**
    不消耗扩张资源，状态保持不变。
    $$ \mathcal{E}^\mathcal{M}(p, k) = (\mathcal{M}(p), k) $$

2.  **假 ($\bot$)**
    $$ \mathcal{E}^\mathcal{M}(\bot, k) = (0, k) $$

3.  **蕴含 ($\varphi \to \psi$)**
    评估顺序为从左到右（Left-to-Right）。$\psi$ 的评估必须基于 $\varphi$ 评估后产生的状态。
    设 $(v_\varphi, k_1) = \mathcal{E}^\mathcal{M}(\varphi, k)$
    设 $(v_\psi, k_2) = \mathcal{E}^\mathcal{M}(\psi, k_1)$
    则：
    $$ \mathcal{E}^\mathcal{M}(\varphi \to \psi, k) = (\max(1 - v_\varphi, v_\psi), k_2) $$

4.  **扩张算子 ($\nabla \varphi$)**
    这是受限扩张性的核心。
    *   步骤 i: 在当前状态 $k$ 下评估 $\varphi$，得到真值 $v_0$ 和中间状态 $k'$。
    *   步骤 ii: 消耗下一个新鲜原子 $x_{k'}$ 来“修改” $\varphi$ 的真值。此处采用 **异或 (XOR)** 作为修改机制（最自然的布尔扰动）。
    *   步骤 iii: 状态计数器加 1。
    
    设 $(v_0, k') = \mathcal{E}^\mathcal{M}(\varphi, k)$
    则：
    $$ \mathcal{E}^\mathcal{M}(\nabla \varphi, k) = (v_0 \oplus \mathcal{M}(x_{k'}), k' + 1) $$
    
    *（注：$\oplus$ 表示模 2 加法，$a \oplus b = (a \neq b)$）*

---

#### **4. 逻辑性质定义**

基于上述动态评估，我们定义逻辑的有效性。

**定义 4.1（公式的满足）**
给定模型 $\mathcal{M}$，公式 $\varphi$ 在状态 $k$ 下被满足，记作 $\mathcal{M}, k \models \varphi$，当且仅当：
$$ \pi_1(\mathcal{E}^\mathcal{M}(\varphi, k)) = 1 $$
其中 $\pi_1$ 是投影对的第一分量（真值）。通常我们关注初始状态 $k=0$。

**定义 4.2（逻辑有效性 / 重言式）**
公式 $\varphi$ 是 $\mathcal{L}_{\nabla}$ 的重言式（记作 $\models \varphi$），当且仅当对于任意模型 $\mathcal{M}$：
$$ \pi_1(\mathcal{E}^\mathcal{M}(\varphi, 0)) = 1 $$

**定义 4.3（语义后承）**
$\Gamma \models \psi$ 当且仅当对于任意模型 $\mathcal{M}$，如果按顺序评估 $\Gamma$ 中的所有公式都为真（且累积状态更新），则在此最终状态下评估 $\psi$ 也为真。
*注意：由于状态更新的非单调性，前提的顺序在 $\mathcal{L}_{\nabla}$ 中是重要的。*

---

### **形式系统特性总结**

1.  **受限性 (Restricted)**：
    *   新原子的引入严格受控于 $\nabla$ 算子的出现次数。
    *   每个 $\nabla$ 实例只消耗一个特定的扩张原子 $x_i$，该原子通过 XOR 操作专门用于翻转被修饰公式的真值。

2.  **扩张性 (Expansive)**：
    *   公式 $\nabla \varphi$ 的真值依赖于原语义空间 $\mathbb{P}$ 之外的信息（即 $\mathbb{X}$ 中的值）。
    *   由于 $\mathcal{M}$ 可以任意赋值 $\mathbb{X}$，$\nabla \varphi$ 本质上引入了“外部扰动”。

3.  **非交换性 (Non-commutative)**：
    *   一般情况下，$\mathcal{E}^\mathcal{M}(\nabla A \land \nabla B) \neq \mathcal{E}^\mathcal{M}(\nabla B \land \nabla A)$ 在涉及具体原子索引时可能不同，但在逻辑有效性层面，由于是对所有模型（所有可能的 $\mathbb{X}$ 赋值）取全称量词，该系统保持了某种形式的对称性。

### **示例推导**

考察公式 $\varphi = \nabla p \to \nabla p$。

1.  给定任意模型 $\mathcal{M}$ 和初始状态 $0$。
2.  评估左边的 $\nabla p$：
    *   评估 $p$: 得到 $(\mathcal{M}(p), 0)$。
    *   应用 $\nabla$: 消耗 $x_0$。真值为 $v_L = \mathcal{M}(p) \oplus \mathcal{M}(x_0)$。
    *   新状态为 $1$。
3.  评估右边的 $\nabla p$（在状态 $1$ 下）：
    *   评估 $p$: 得到 $(\mathcal{M}(p), 1)$。
    *   应用 $\nabla$: 消耗 $x_1$。真值为 $v_R = \mathcal{M}(p) \oplus \mathcal{M}(x_1)$。
    *   新状态为 $2$。
4.  评估蕴含 $\to$:
    *   结果真值为 $\max(1 - v_L, v_R)$。
    
由于 $\mathcal{M}(x_0)$ 和 $\mathcal{M}(x_1)$ 是相互独立的变量，存在模型使得 $v_L=1$ 且 $v_R=0$（例如 $\mathcal{M}(p)=0, \mathcal{M}(x_0)=1, \mathcal{M}(x_1)=0$）。
因此，**$\nabla p \to \nabla p$ 不是重言式**。这精确反映了“每次使用算子都引入新原子”的直觉：第一次扰动和第二次扰动是不相关的。
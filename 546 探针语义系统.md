# 结构化及其探针语义系统 (SPS)

## 1. 基础结构定义

**定义 1.1 (基础论域与序结构)**
设 $A$ 为任意非空集合。
定义 $\preceq$ 为 $A$ 上的一个良序关系 (Well-ordering relation)，使得 $(A, \preceq)$ 为良序集。即对于 $A$ 的任意非空子集 $S \subseteq A$，存在唯一的最小元素 $\min(S)$。

**定义 1.2 (维度与向量空间)**
设 $n \in \mathbb{Z}^+$ 为固定的正整数。
定义 $A^n$ 为 $A$ 的 $n$ 次笛卡尔积。
定义 $A^n$ 上的导出良序 $\preceq_n$ 为基于 $\preceq$ 的字典序 (Lexicographical order)。
对于任意 $\vec{x}, \vec{y} \in A^n$，若 $\vec{x} \preceq_n \vec{y}$ 且 $\vec{x} \neq \vec{y}$，记作 $\vec{x} \prec_n \vec{y}$。

**定义 1.3 (语义全集)**
定义系统论域 $U$ 为从 $A^n$ 到 $A$ 的所有映射的集合：
$$ U = \{ f \mid f: A^n \to A \} $$

---

## 2. 辅助算子定义

为了构建主算子，定义以下两个辅助映射。

**定义 2.1 (对角化注入算子)**
定义映射 $\Delta: A \to A^n$。对于任意 $a \in A$：
$$ \Delta(a) = (a, a, \dots, a) $$
此算子将标量值扩展为对角线向量。

**定义 2.2 (典型逆像选择算子)**
对于任意 $f \in U$，定义选择函数 $\sigma_f: A \to A^n \cup \{\bot\}$。
对于任意 $v \in A$：
$$
\sigma_f(v) =
\begin{cases}
\min_{\preceq_n} \{ \vec{y} \in A^n \mid f(\vec{y}) = v \} & \text{若 } v \in \text{Range}(f) \\
\bot & \text{若 } v \notin \text{Range}(f)
\end{cases}
$$
其中 $\min_{\preceq_n}$ 依据定义 1.2 给出的良序进行选取，确保结果的唯一性。

---

## 3. 语义算子形式化

### 3.1 二元算子：探针算子 (Probe Operator)

**定义 3.1.1**
定义二元算子 $\Phi: U \times U \to U$。
对于任意 $f, g \in U$，记 $h = \Phi(f, g)$。
$h$ 的语义通过以下映射构造给出：

$$ \forall \vec{x} = (x_1, x_2, \dots, x_n) \in A^n, \quad h(\vec{x}) = f \big( g(\Delta(x_1)), \, g(\Delta(x_2)), \, \dots, \, g(\Delta(x_n)) \big) $$

**语义说明**：
*   $g \circ \Delta$ 构成了 $g$ 的可定义一元特征函数（对角线切片）。
*   该特征分别作用于输入向量 $\vec{x}$ 的每一个分量。
*   $f$ 作为探针，接受这 $n$ 个特征值作为参数，生成最终语义。

---

### 3.2 三元算子：转导算子 (Transductive Operator)

**定义 3.2.1 (关联图构造)**
对于任意 $f, g, h \in U$，定义 $n+1$ 元关系集 $\mathcal{G}_{f,g,h} \subset A^n \times A$：

$$ \mathcal{G}_{f,g,h} = \{ (\vec{x}, y) \mid \vec{x} \in A^n, \, y = \mathcal{T}(f,g,h, \vec{x}) \} $$

其中辅助求值函数 $\mathcal{T}: U \times U \times U \times A^n \to A$ 定义为：

$$
\mathcal{T}(f, g, h, \vec{x}) =
\begin{cases}
g(\sigma_f(h(\vec{x}))) & \text{若 } \sigma_f(h(\vec{x})) \neq \bot \\
h(\vec{x}) & \text{若 } \sigma_f(h(\vec{x})) = \bot
\end{cases}
$$

**定理 3.2.2 (唯一同构性)**
集合 $\mathcal{G}_{f,g,h}$ 满足函数的定义条件（单值性与完全性），因此唯一同构于一个 $n$ 元映射 $k \in U$。

**定义 3.2.3 (算子定义)**
定义三元算子 $\Psi: U \times U \times U \to U$。
$\Psi(f, g, h)$ 的值为上述定理 3.2.2 确定的唯一映射 $k$。
形式化地：

$$ \Psi(f, g, h)(\vec{x}) = \mathcal{T}(f, g, h, \vec{x}) $$

---

## 4. 系统总成

**定义 4.1 (形式系统)**
结构化及其探针语义系统 (SPS) 定义为六元组：
$$ \mathcal{S} = \langle A, \preceq, n, U, \Phi, \Psi \rangle $$
满足：
1.  $(A, \preceq)$ 是良序集。
2.  $n \ge 1$ 是维数。
3.  $U = A^{A^n}$ 是语义空间。
4.  $\Phi$ 是定义 3.1.1 给出的探针算子。
5.  $\Psi$ 是定义 3.2.3 给出的转导算子。

此系统是封闭的，并且对于 $U$ 中的任意输入，算子结果唯一确定。

---

## 5. 形式语言

为公理化 SPS 系统，我们定义以下形式语言 $\mathcal{L}_{\text{SPS}}$。

**定义 5.1 (排序 Sorts)**
$\mathcal{L}_{\text{SPS}}$ 包含三个排序：
1.  $\mathcal{A}$：基础论域 $A$ 的元素。
2.  $\mathcal{V}_n$：$n$ 维向量空间 $A^n$ 的元素。
3.  $\mathcal{U}$：语义全集 $U$ 的元素。

**定义 5.2 (常量符号 Constant Symbols)**
1.  $n \in \mathbb{Z}^+$：维度常量。
2.  $\bot$：特殊常量，表示未定义。

**定义 5.3 (关系符号 Relation Symbols)**
1.  $\preceq \, \subseteq \mathcal{A} \times \mathcal{A}$：二元关系。
2.  $\preceq_n \, \subseteq \mathcal{V}_n \times \mathcal{V}_n$：二元关系。
3.  $=$：所有排序上的等价关系。

**定义 5.4 (函数符号 Function Symbols)**
1.  `apply`: $\mathcal{U} \times \mathcal{V}_n \to \mathcal{A}$。为方便起见，记作 $f(\vec{x})$。
2.  $\Delta: \mathcal{A} \to \mathcal{V}_n$
3.  $\sigma: \mathcal{U} \times \mathcal{A} \to \mathcal{V}_n \cup \{\bot\}$。为方便起见，记作 $\sigma_f(v)$。
4.  $\Phi: \mathcal{U} \times \mathcal{U} \to \mathcal{U}$
5.  $\Psi: \mathcal{U} \times \mathcal{U} \times \mathcal{U} \to \mathcal{U}$

---

## 6. 公理系统 $\text{Ax(SPS)}$

所有变量均被全称量词约束，除非另有说明。

### 6.1 基础结构公理

**公理 6.1.1 (非空性)**
$\exists a \in \mathcal{A} \, (a=a)$

**公理 6.1.2 (良序关系)**
关系 $\preceq$ 是排序 $\mathcal{A}$ 上的一个良序关系：
1.  (自反性) $\forall a \in \mathcal{A} \, (a \preceq a)$
2.  (反对称性) $\forall a, b \in \mathcal{A} \, ((a \preceq b \land b \preceq a) \implies a = b)$
3.  (传递性) $\forall a, b, c \in \mathcal{A} \, ((a \preceq b \land b \preceq c) \implies a \preceq c)$
4.  (完全性) $\forall a, b \in \mathcal{A} \, (a \preceq b \lor b \preceq a)$
5.  (良基性) $\forall S \subseteq \mathcal{A} \, ((\exists s \in S) \implies (\exists m \in S \, \forall s' \in S \, (m \preceq s')))$

**公理 6.1.3 (字典序)**
关系 $\preceq_n$ 是由 $\preceq$ 在 $\mathcal{V}_n$ 上导出的字典序。对于 $\vec{x}, \vec{y} \in \mathcal{V}_n$，令 $x_i, y_i$ 分别为其第 $i$ 个分量：
$$ \vec{x} \preceq_n \vec{y} \iff \left( \vec{x} = \vec{y} \lor \exists k \in \{1,\dots,n\} \left( (\forall i < k, x_i = y_i) \land x_k \prec y_k \right) \right) $$
其中 $a \prec b$ 是 $a \preceq b \land a \neq b$ 的简写。

### 6.2 语义空间公理

**公理 6.2.1 (函数空间)**
排序 $\mathcal{U}$ 是从 $\mathcal{V}_n$到 $\mathcal{A}$ 的所有函数的集合：
$$ \mathcal{U} = \{ f \mid f: \mathcal{V}_n \to \mathcal{A} \} $$

### 6.3 辅助算子公理

**公理 6.3.1 (对角化注入)**
$$ \forall a \in \mathcal{A}, \forall i \in \{1,\dots,n\} \quad (\Delta(a))_i = a $$
其中 $(\cdot)_i$ 表示向量到其第 $i$ 个分量的投影。

**公理 6.3.2 (典型逆像选择)**
$$
\forall f \in \mathcal{U}, \forall v \in \mathcal{A} \quad
\sigma_f(v) =
\begin{cases}
\min_{\preceq_n} \{ \vec{y} \in \mathcal{V}_n \mid f(\vec{y}) = v \} & \text{若 } v \in \{ f(\vec{z}) \mid \vec{z} \in \mathcal{V}_n \} \\
\bot & \text{否则}
\end{cases}
$$

### 6.4 主语义算子公理

**公理 6.4.1 (探针算子)**
$$
\forall f, g \in \mathcal{U}, \forall \vec{x} \in \mathcal{V}_n \\
\left( (\Phi(f,g))(\vec{x}) = f \big( g(\Delta(x_1)), \, g(\Delta(x_2)), \, \dots, \, g(\Delta(x_n)) \big) \right)
$$

**公理 6.4.2 (转导算子)**
$$
\forall f, g, h \in \mathcal{U}, \forall \vec{x} \in \mathcal{V}_n \\
(\Psi(f,g,h))(\vec{x}) =
\begin{cases}
g(\sigma_f(h(\vec{x}))) & \text{若 } \sigma_f(h(\vec{x})) \neq \bot \\
h(\vec{x}) & \text{若 } \sigma_f(h(\vec{x})) = \bot
\end{cases}
$$
# 命题变量分析演算
## 1. 语法 (Syntax)

### **定义 1.1：语言的符号表 (Alphabet)**

本系统的符号表由以下三部分构成：
1.  一个可数的命题变量集合 $P = \{p, q, r, \dots\}$。
2.  两个二元算子符号集合 $O = \{\mathbf{1}, \mathbf{2}\}$。
3.  辅助符号：$($, $)$。

### **定义 1.2：合式公式 (Well-formed Formulas)**

合式公式的集合，记为 $\mathcal{L}$，通过以下规则归纳定义：

1.  **基础情况**: 若 $p \in P$，则 $p \in \mathcal{L}$。
2.  **归纳步骤**: 若 $\phi, \psi \in \mathcal{L}$，则：
    *   $(\phi \mathbf{1} \psi) \in \mathcal{L}$
    *   $(\phi \mathbf{2} \psi) \in \mathcal{L}$

为书写便利，我们将省略表达式最外层的括号。


---

## **2. 语义 (Semantics)**

本节定义了语言 $\mathcal{L}$ 的形式语义。每个合式公式 $\phi \in \mathcal{L}$ 都被映射到一个定义其接口、变量范围和内部链接结构的语义值。

### **定义 2.1：语义值的结构**

一个合式公式 $\phi$ 的语义值，记作 $⟦\phi⟧$，是一个三元组：
$$⟦\phi⟧ = (V_\phi, \text{Var}_\phi, M_\phi)$$
其中：
1.  $V_\phi \subseteq P$：是公式的**接口变量集 (Interface Variables)**。
2.  $\text{Var}_\phi \subseteq P$：是公式的**总变量集 (Total Variables)**。
3.  $M_\phi \subseteq P \times P$：是公式的**链接映射 (Link Mapping)**，一个在命题变量集合 $P$ 上的二元关系。

语义函数 $⟦\cdot⟧$ 的类型签名为：
$$⟦\cdot⟧: \mathcal{L} \to (\mathcal{P}(P) \times \mathcal{P}(P) \times \mathcal{P}(P \times P))$$
其中 $\mathcal{P}(S)$ 表示集合 $S$ 的幂集。

### **定义 2.2：辅助函数 `Var`**

总变量集 $\text{Var}_\phi$ 等价于一个纯粹基于语法的辅助函数 $\text{Var}(\phi)$ 的值。该函数通过对公式结构进行归纳定义如下：
1.  对任意 $p \in P$，$\text{Var}(p) = \{p\}$。
2.  对任意 $\phi, \psi \in \mathcal{L}$ 及 $\odot \in \{\mathbf{1}, \mathbf{2}\}$，$\text{Var}(\phi \odot \psi) = \text{Var}(\phi) \cup \text{Var}(\psi)$。

### **定义 2.3：语义函数 $⟦\cdot⟧$**

语义函数 $⟦\cdot⟧$ 通过对合式公式的结构进行归纳定义。

#### **1. 基础情况 (命题变量)**

对任意命题变量 $p \in P$：
$$⟦p⟧ = (\{p\}, \{p\}, \emptyset)$$

#### **2. 归纳步骤 (算子 $\mathbf{2}$)**

令 $\phi = \alpha \mathbf{2} \beta$，并假设 $⟦\alpha⟧ = (V_\alpha, \text{Var}_\alpha, M_\alpha)$ 和 $⟦\beta⟧ = (V_\beta, \text{Var}_\beta, M_\beta)$ 已定义。则 $⟦\phi⟧ = (V_\phi, \text{Var}_\phi, M_\phi)$ 定义为：
1.  $V_\phi = V_\alpha \cup V_\beta$
2.  $\text{Var}_\phi = \text{Var}_\alpha \cup \text{Var}_\beta$
3.  $M_\phi = M_\alpha \cup M_\beta$

#### **3. 归纳步骤 (算子 $\mathbf{1}$)**

令 $\phi = \alpha \mathbf{1} \beta$，并假设 $⟦\alpha⟧ = (V_\alpha, \text{Var}_\alpha, M_\alpha)$ 和 $⟦\beta⟧ = (V_\beta, \text{Var}_\beta, M_\beta)$ 已定义。则 $⟦\phi⟧ = (V_\phi, \text{Var}_\phi, M_\phi)$ 定义为：
1.  $V_\phi = V_\alpha \cap V_\beta$
2.  $\text{Var}_\phi = \text{Var}_\alpha \cup \text{Var}_\beta$
3.  $M_\phi = (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha)$

## 3. 希尔伯特公理系统 $\mathcal{H}_{Link}$

本节定义逻辑系统 $\mathcal{H}_{Link}$ 的推演规则与公理。该系统基于等式逻辑（Equational Logic），其判断形式为公式间的语义等价。

### **定义 3.1：推演判断 (Judgement)**

系统的基本推演对象为如下形式的等式：

$$\vdash \phi \equiv \psi$$

其中 $\phi, \psi \in \mathcal{L}$。该等式由一个等式的推演序列得到，其中每一个等式要么是一个公理的实例，要么前面的等式出现了与推理规则的前件句法相同的等式。

#### **3.2 替换的定义 (Definition of Substitution)**

##### **定义 3.2.0：接口变量的句法函数 (Syntactic Function for Interface Variables)**

我们定义一个函数 $\text{Interface}: \mathcal{L} \to \mathcal{P}(P)$，通过对公式结构进行归纳定义如下：

1.  **基础情况**: 对任意 $p \in P$，$\text{Interface}(p) = \{p\}$。
2.  **归纳步骤 (算子 $\mathbf{2}$)**: 对任意 $\phi, \psi \in \mathcal{L}$，
    $\text{Interface}(\phi \mathbf{2} \psi) = \text{Interface}(\phi) \cup \text{Interface}(\psi)$。
3.  **归纳步骤 (算子 $\mathbf{1}$)**: 对任意 $\phi, \psi \in \mathcal{L}$，
    $\text{Interface}(\phi \mathbf{1} \psi) = \text{Interface}(\phi) \cap \text{Interface}(\psi)$。

这个函数是纯句法的，因为它不依赖于语义函数 $⟦\cdot⟧$ 的任何结果。

##### **定义 3.2.1: 绑定变量集 (Bound Variables)**

对于一个复合公式 $\phi = \alpha \mathbf{1} \beta$，其**绑定变量集 (Bound Variables)** $B(\phi)$，**左绑定集 (Left-Bound Variables)** $B_L(\phi)$ 和**右绑定集 (Right-Bound Variables)** $B_R(\phi)$ 定义如下：

1.  $B_L(\phi) = \text{Interface}(\alpha) \setminus \text{Interface}(\beta)$
2.  $B_R(\phi) = \text{Interface}(\beta) \setminus \text{Interface}(\alpha)$
3.  $B(\phi) = B_L(\phi) \cup B_R(\phi)$

对于命题变量或由算子 **2** 构造的公式，其绑定变量集为空集。

##### **定义 3.2.2：无捕获替换 (Capture-Avoiding Substitution)**

替换操作 $\phi\{p \mapsto \delta\}$ 通过对公式 $\phi$ 的结构进行归纳定义：

1.  **基础情况 (命题变量)**:
    若 $\phi = q \in P$：
    $$q\{p \mapsto \delta\} = \begin{cases} \delta & \text{若 } q = p \\ q & \text{若 } q \neq p \end{cases}$$

2.  **归纳步骤 (算子 $\mathbf{2}$)**:
    若 $\phi = \alpha \mathbf{2} \beta$：
    $$(\alpha \mathbf{2} \beta)\{p \mapsto \delta\} = (\alpha\{p \mapsto \delta\}) \mathbf{2} (\beta\{p \mapsto \delta\})$$

3.  **归纳步骤 (算子 $\mathbf{1}$)**:
    若 $\phi = \alpha \mathbf{1} \beta$：
    *   **情况 A**: 若 $p \notin B(\phi)$ (即 $p$ 不是 $\phi$ 的绑定变量)：
        $$(\alpha \mathbf{1} \beta)\{p \mapsto \delta\} = (\alpha\{p \mapsto \delta\}) \mathbf{1} (\beta\{p \mapsto \delta\})$$
    *   **情况 B**: 若 $p \in B_L(\phi)$ (即 $p$ 是左绑定变量)：
        令冲突集 $C = \text{Var}(\delta) \cap B_R(\phi)$。
        *   若 $C = \emptyset$，则替换是安全的：
            $$(\alpha \mathbf{1} \beta)\{p \mapsto \delta\} = (\alpha\{p \mapsto \delta\}) \mathbf{1} \beta$$
        *   若 $C = \{c_1, \dots, c_k\} \neq \emptyset$，则必须重命名。选择一组新的、不出现于 $\text{Var}(\alpha) \cup \text{Var}(\beta) \cup \text{Var}(\delta)$ 中的变量 $\{c'_1, \dots, c'_k\}$。构造重命名替换 $\sigma = \{c_1 \mapsto c'_1, \dots, c_k \mapsto c'_k\}$。令 $\beta' = \beta\{\sigma\}$，则：
            $$(\alpha \mathbf{1} \beta)\{p \mapsto \delta\} = (\alpha\{p \mapsto \delta\}) \mathbf{1} \beta'$$
            其中 $\beta\{\sigma\}$ 表示对 $\beta$ 顺序应用 $\sigma$ 中的每一个单变量替换。
    *   **情况 C**: 若 $p \in B_R(\phi)$ (即 $p$ 是右绑定变量)：
        令冲突集 $C = \text{Var}(\delta) \cap B_L(\phi)$。
        *   若 $C = \emptyset$，则替换是安全的：
            $$(\alpha \mathbf{1} \beta)\{p \mapsto \delta\} = \alpha \mathbf{1} (\beta\{p \mapsto \delta\})$$
        *   若 $C \neq \emptyset$，则进行对称的重命名操作。选择新变量构造重命名替换 $\sigma$，令 $\alpha' = \alpha\{\sigma\}$，则：
            $$(\alpha \mathbf{1} \beta)\{p \mapsto \delta\} = \alpha' \mathbf{1} (\beta\{p \mapsto \delta\})$$
### **3.3 公理模式 (Axiom Schemata)**

A1. 自反律 (Reflexivity)

对任意 $\phi \in \mathcal{L}$：

$$\vdash \phi \equiv \phi$$

A2. 对称律 (Symmetry)

$$\vdash \phi \equiv \psi \implies \vdash \psi \equiv \phi$$

A3. 传递律 (Transitivity)

$$\vdash \phi \equiv \psi, \ \vdash \psi \equiv \chi \implies \vdash \phi \equiv \chi$$

A4. 算子 $\mathbf{2}$ 的交换律 (Commutativity for $\mathbf{2}$)

$$\vdash \phi \mathbf{2} \psi \equiv \psi \mathbf{2} \phi$$

A5. 算子 $\mathbf{2}$ 的结合律 (Associativity for $\mathbf{2}$)

$$\vdash (\phi \mathbf{2} \psi) \mathbf{2} \chi \equiv \phi \mathbf{2} (\psi \mathbf{2} \chi)$$

A6. 算子 $\mathbf{2}$ 的幂等律 (Idempotence for $\mathbf{2}$)

$$\vdash \phi \mathbf{2} \phi \equiv \phi$$

A7. 吸收律 (Absorption Law)

$$\vdash (\phi \mathbf{1} \phi) \mathbf{2} \phi \equiv \phi$$

A8. 子集交换律 (Subset Commutativity)

$$\vdash \phi \mathbf{1} (\phi \mathbf{2} \psi) \equiv (\phi \mathbf{2} \psi) \mathbf{1} \phi$$

A9. 链接消除的同态律 (Link Erasure Homomorphism)

$$\vdash (\phi \mathbf{1} \phi) \mathbf{2} (\psi \mathbf{1} \psi) \equiv (\phi \mathbf{2} \psi) \mathbf{1} (\phi \mathbf{2} \psi)$$

A10. 上下文链接消除律 (Contextual Link Erasure)

$$\vdash \gamma \mathbf{2} (\gamma \mathbf{1} \phi) \equiv \gamma \mathbf{2} (\gamma \mathbf{1} (\phi \mathbf{1} \phi))$$

A11. 链接逆反湮灭律 (Link Inversion Annihilation)

$$\vdash (\alpha \mathbf{1} \beta) \mathbf{1} (\beta \mathbf{1} \alpha) \equiv (\alpha \mathbf{1} \beta) \mathbf{1} (\alpha \mathbf{1} \beta)$$

A12. 右侧链接无关律 (Right-Side Link Irrelevance)
$$\vdash \alpha \mathbf{1} \beta \equiv \alpha \mathbf{1} (\beta \mathbf{1} \beta)$$

A13. 左侧链接无关律 (Left-Side Link Irrelevance)
$$\vdash \alpha \mathbf{1} \beta \equiv (\alpha \mathbf{1} \alpha) \mathbf{1} \beta$$

A14. 链接消除的吸收律 (Absorption of Link Erasure)
$$\vdash (\phi \mathbf{1} \phi) \mathbf{1} \phi \equiv \phi \mathbf{1} \phi$$


### **3.4 推理规则 (Inference Rules)**

R1. 算子 $\mathbf{2}$ 的同余规则 (Congruence for $\mathbf{2}$)

若子公式在语义上等价，则它们在构造 $\mathbf{2}$ 结构时保持等价。

$$\frac{\vdash \alpha \equiv \alpha' \quad \vdash \beta \equiv \beta'}{\vdash \alpha \mathbf{2} \beta \equiv \alpha' \mathbf{2} \beta'}$$

R2. 算子 $\mathbf{1}$ 的同余规则 (Congruence for $\mathbf{1}$)

若子公式在语义上等价，则它们在构造 $\mathbf{1}$ 链接时保持等价。

$$\frac{\vdash \alpha \equiv \alpha' \quad \vdash \beta \equiv \beta'}{\vdash \alpha \mathbf{1} \beta \equiv \alpha' \mathbf{1} \beta'}$$

R3. 替换规则 (Substitution Rule)

若一个等式可证，则对该等式两端的公式进行无捕获替换后得到的等式仍然可证。

$$\frac{\vdash \phi \equiv \psi}{\vdash \phi\{p \mapsto \delta\} \equiv \psi\{p \mapsto \delta\}}$$

R4. 外延性规则 (Rule of Extensionality)

设 $p$ 为一个命题变量，且 $p \notin \text{Var}(\alpha) \cup \text{Var}(\beta)$。
$$\frac{\vdash p \mathbf{1} \alpha \equiv p \mathbf{1} \beta}{\vdash \alpha \mathbf{1} \alpha \equiv \beta \mathbf{1} \beta}$$

---

## **4. 定理 L0: 唯一可读性定理 (Unique Readability Theorem)**

对于任意合式公式 $\phi \in \mathcal{L}$，以下三项中必有且仅有一项成立：
1.  $\phi$ 是一个命题变量 (即 $\phi \in P$)。
2.  存在唯一的合式公式 $\alpha, \beta \in \mathcal{L}$，使得 $\phi = (\alpha \mathbf{1} \beta)$。
3.  存在唯一的合式公式 $\alpha, \beta \in \mathcal{L}$，使得 $\phi = (\alpha \mathbf{2} \beta)$。

**证明**:
证明分为两个部分：
*   **第一部分：存在性与互斥性 (Existence and Mutual Exclusivity)**：证明对于任意 $\phi \in \mathcal{L}$，三种情况中恰好有一种情况发生。
*   **第二部分：唯一性 (Uniqueness)**：证明在情况2和情况3中，子公式 $\alpha$ 和 $\beta$ 是唯一确定的。

为进行此证明，我们首先需要建立一个关于括号平衡的关键引理。

### **引理 L0.1: 括号平衡引理 (Parenthesis Balancing Lemma)**

对于任意符号串 $s$，我们定义函数 $bal(s)$ 为 $s$ 中左括号 `(` 的数量减去右括号 `)` 的数量。
1.  对于任意合式公式 $\phi \in \mathcal{L}$，有 $bal(\phi) = 0$。
2.  对于任意合式公式 $\phi \in \mathcal{L}$，若 $\phi$ 不是命题变量 (即 $\phi$ 是复合公式)，则对于 $\phi$ 的任意**真前缀 (proper prefix)** $s$，有 $bal(s) > 0$。

**引理 L0.1 的证明**:
我们对合式公式 $\phi$ 的结构进行归纳。

**证明第1部分 ($bal(\phi) = 0$)**:
*   **基础情况**: $\phi = p$，其中 $p \in P$。$p$ 中不含括号，因此 $bal(p) = 0 - 0 = 0$。
*   **归纳步骤**: 假设对于 $\alpha, \beta \in \mathcal{L}$，有 $bal(\alpha) = 0$ 和 $bal(\beta) = 0$。
    令 $\phi = (\alpha \odot \beta)$，其中 $\odot \in \{\mathbf{1}, \mathbf{2}\}$。
    $bal(\phi) = bal(`(`) + bal(\alpha) + bal(\odot) + bal(\beta) + bal(`)`) = 1 + 0 + 0 + 0 - 1 = 0$。
    因此，对于所有 $\phi \in \mathcal{L}$，均有 $bal(\phi) = 0$。

**证明第2部分 ($bal(s) > 0$)**:
我们对复合公式 $\phi$ 的长度（符号数量）进行归纳。
*   **基础情况**: 最短的复合公式形如 $(p \odot q)$，其中 $p,q \in P$。其真前缀 $s$ 及其平衡值为：
    *   $s = `(`$，$bal(s) = 1 > 0$。
    *   $s = `(p`$，$bal(s) = 1 > 0$。
    *   $s = `(p \odot`$，$bal(s) = 1 > 0$。
    *   $s = `(p \odot q`$，$bal(s) = 1 > 0$。
    基础情况成立。
*   **归纳步骤**: 假设对于所有长度小于 $|\phi|$ 的复合公式，该性质成立。令 $\phi = (\alpha \odot \beta)$。令 $s$ 为 $\phi$ 的一个真前缀。
    *   **情况 i**: $s = `(`$。$bal(s) = 1 > 0$。
    *   **情况 ii**: $s = `(`s'$，其中 $s'$ 是 $\alpha$ 的一个前缀 (可以是 $\alpha$ 本身)。
        $bal(s) = 1 + bal(s')$。
        *   若 $s'$ 是 $\alpha$ 的一个真前缀：
            *   如果 $\alpha$ 是命题变量，则 $s'$ 为空串，$bal(s')=0$，因此 $bal(s) = 1 > 0$。
            *   如果 $\alpha$ 是复合公式，根据归纳假设（因为 $|\alpha| < |\phi|$），$bal(s') > 0$。因此 $bal(s) = 1 + bal(s') > 1 > 0$。
        *   若 $s' = \alpha$：根据引理的第1部分，$bal(\alpha)=0$。因此 $bal(s) = 1 + 0 = 1 > 0$。
    *   **情况 iii**: $s = `(\alpha \odot`$。$bal(s) = bal(`(`) + bal(\alpha) + bal(\odot) = 1 + 0 + 0 = 1 > 0$。
    *   **情况 iv**: $s = `(\alpha \odot s''`$，其中 $s''$ 是 $\beta$ 的一个前缀 (可以是 $\beta$ 本身)。由于 $s$ 是 $\phi$ 的真前缀，所以 $s''$ 不能是 $\beta$ 同时 $s$ 缺少最后的 `)`.
        $bal(s) = 1 + bal(\alpha) + bal(\odot) + bal(s'') = 1 + 0 + 0 + bal(s'') = 1 + bal(s'')$。
        *   若 $s''$ 是 $\beta$ 的一个真前缀：
            *   如果 $\beta$ 是命题变量，$s''$ 为空串，$bal(s'')=0$，因此 $bal(s) = 1 > 0$。
            *   如果 $\beta$ 是复合公式，根据归纳假设，$bal(s'') > 0$。因此 $bal(s) = 1 + bal(s'') > 1 > 0$。
        *   若 $s'' = \beta$：$s = `(\alpha \odot \beta`$。根据引理第1部分，$bal(\beta)=0$。因此 $bal(s) = 1+0=1 > 0$。
    在所有情况下，对于 $\phi$ 的任意真前缀 $s$，都有 $bal(s)>0$。引理 L0.1 证毕。

### **引理 L0.2: 非前缀引理 (Non-prefix Lemma)**

任意合式公式 $\phi \in \mathcal{L}$ 都不是另一个合式公式 $\psi \in \mathcal{L}$ 的真前缀。

**证明**:
假设存在 $\phi, \psi \in \mathcal{L}$ 使得 $\phi$ 是 $\psi$ 的一个真前缀。
根据引理 L0.1 的第1部分，我们有 $bal(\phi) = 0$。
根据定义，$\phi$ 也是 $\psi$ 的一个真前缀。
*   若 $\psi$ 是命题变量，它不可能有另一个合式公式作为其真前缀（因为最短的合式公式长度为1）。
*   若 $\psi$ 是复合公式，根据引理 L0.1 的第2部分，它的任何真前缀 $s$ 都必须满足 $bal(s) > 0$。
    既然 $\phi$ 是 $\psi$ 的一个真前缀，那么必有 $bal(\phi) > 0$。
这与 $bal(\phi) = 0$ 矛盾。因此，我们的初始假设不成立。引理 L0.2 证毕。

### **唯一可读性定理的证明 (续)**

**第一部分：存在性与互斥性**

*   **存在性**: 根据合式公式的归纳定义，任何 $\phi \in \mathcal{L}$ 要么是一个命题变量（基础情况），要么是通过归纳步骤从更简单的公式构造而来，即形如 $(\alpha \mathbf{1} \beta)$ 或 $(\alpha \mathbf{2} \beta)$。因此，三者必居其一。
*   **互斥性**:
    1.  **情况1 vs 情况2/3**: 命题变量是来自集合 $P$ 的单个符号。而复合公式的长度至少为5（例如 $(p \mathbf{1} q)$），并且必须以 `(` 开头。因此，一个公式不可能是命题变量的同时又是复合公式。
    2.  **情况2 vs 情况3**: 假设一个公式 $\phi$ 同时满足 $\phi = (\alpha \mathbf{1} \beta)$ 和 $\phi = (\gamma \mathbf{2} \delta)$。作为符号串，这意味着它们在每个位置的符号都相同。特别地，在第一个子公式之后的位置上，符号必须既是 $\mathbf{1}$ 又是 $\mathbf{2}$。但 $\mathbf{1}$ 和 $\mathbf{2}$ 是符号表中不同的符号，这是不可能的。
    因此，这三种情况是两两互斥的。

**第二部分：唯一性**

我们需要证明，如果一个公式可以被看作是复合公式，那么其分解方式是唯一的。
假设 $\phi = (\alpha \odot \beta)$ 且 $\phi = (\gamma \odot \delta)$，其中 $\alpha, \beta, \gamma, \delta \in \mathcal{L}$ 且 $\odot \in \{\mathbf{1}, \mathbf{2}\}$。我们需要证明 $\alpha = \gamma$ 和 $\beta = \delta$。

从字符串等式 $(\alpha \odot \beta) = (\gamma \odot \delta)$，我们可以消去两端相同的括号，得到：
$$ \alpha \odot \beta = \gamma \odot \delta $$
这意味着字符串 $\alpha$ 是字符串 $\gamma \odot \delta$ 的前缀，同时 $\gamma$ 是字符串 $\alpha \odot \beta$ 的前缀。

不失一般性，我们考虑两种可能：
1.  **$|\alpha| = |\gamma|$ (长度相等)**: 如果两个前缀长度相等，它们必须是相同的字符串。因此 $\alpha = \gamma$。将此代入等式 $\alpha \odot \beta = \gamma \odot \delta$ 中，可以立即推导出 $\odot \beta = \odot \delta$，进而得到 $\beta = \delta$。
2.  **$|\alpha| \neq |\gamma|$ (长度不等)**: 不失一般性，假设 $|\alpha| < |\gamma|$。这意味着 $\alpha$ 是 $\gamma$ 的一个真前缀。然而，$\alpha$ 和 $\gamma$ 都是合式公式。这直接违反了我们刚刚证明的**引理 L0.2 (非前缀引理)**，该引理断言任何合式公式都不可能是另一个合式公式的真前缀。

因此，长度不等的情况是不可能的。唯一可能的情况是 $|\alpha| = |\gamma|$，这导致了 $\alpha = \gamma$ 和 $\beta = \delta$。
这就证明了对于给定的算子 $\odot$，子公式 $\alpha$ 和 $\beta$ 的分解是唯一的。

综上所述，我们已经证明了对于任意合式公式，它精确地属于三种类型之一，并且如果它是复合公式，其直接子成分是唯一确定的。

**唯一可读性定理 L0 证毕。**

***

## **5. 替换系统与语义的协调性**

本节旨在以严格的形式，建立句法替换与语义模型之间的桥梁。

#### **引理 S1: 接口函数对应引理 (Interface Function Correspondence Lemma)**

对于任意合式公式 $\phi \in \mathcal{L}$，恒有 $\text{Interface}(\phi) = V_\phi$。

**证明**:

本证明采用对合式公式 $\phi$ 的结构进行归纳的方法。我们将依据定义 1.2 中 $\mathcal{L}$ 的构造规则，验证该等式在基础情况和归纳步骤中均成立。

1.  **基础情况**: 设 $\phi = p$，其中 $p$ 是一个命题变量 ($p \in P$)。
    *   根据定义 3.2.0 (Interface 函数)，$\text{Interface}(p) = \{p\}$。
    *   根据定义 2.3.1 (语义函数)，$⟦p⟧ = (\{p\}, \{p\}, \emptyset)$。因此，其接口变量集 $V_p = \{p\}$。
    *   比较两者可得 $\text{Interface}(p) = V_p$。故基础情况成立。

2.  **归纳假设**: 假设对于任意合式公式 $\alpha, \beta \in \mathcal{L}$，引理均成立。即：
    *   $\text{Interface}(\alpha) = V_\alpha$
    *   $\text{Interface}(\beta) = V_\beta$

3.  **归纳步骤**: 我们需要证明对于由 $\alpha$ 和 $\beta$ 构造的复合公式，引理依然成立。根据唯一可读性定理 (L0)，复合公式只有以下两种情况：

    *   **情况 i**: 设 $\phi = \alpha \mathbf{2} \beta$。
        *   根据定义 3.2.0，$\text{Interface}(\phi) = \text{Interface}(\alpha \mathbf{2} \beta) = \text{Interface}(\alpha) \cup \text{Interface}(\beta)$。
        *   根据定义 2.3.2，$⟦\phi⟧$ 的接口变量集 $V_\phi = V_{\alpha \mathbf{2} \beta} = V_\alpha \cup V_\beta$。
        *   应用归纳假设，我们将 $\text{Interface}(\alpha)$ 和 $\text{Interface}(\beta)$ 分别替换为 $V_\alpha$ 和 $V_\beta$，得到 $\text{Interface}(\phi) = V_\alpha \cup V_\beta$。
        *   因此，$\text{Interface}(\phi) = V_\phi$。

    *   **情况 ii**: 设 $\phi = \alpha \mathbf{1} \beta$。
        *   根据定义 3.2.0，$\text{Interface}(\phi) = \text{Interface}(\alpha \mathbf{1} \beta) = \text{Interface}(\alpha) \cap \text{Interface}(\beta)$。
        *   根据定义 2.3.3，$⟦\phi⟧$ 的接口变量集 $V_\phi = V_{\alpha \mathbf{1} \beta} = V_\alpha \cap V_\beta$。
        *   应用归纳假设，我们将 $\text{Interface}(\alpha)$ 和 $\text{Interface}(\beta)$ 分别替换为 $V_\alpha$ 和 $V_\beta$，得到 $\text{Interface}(\phi) = V_\alpha \cap V_\beta$。
        *   因此，$\text{Interface}(\phi) = V_\phi$。

由于基础情况成立，且归纳步骤对所有构造规则均成立，根据结构归纳原理，该引理对所有合式公式 $\phi \in \mathcal{L}$ 均成立。

□

---

#### **定理 S2: 替换引理 (Substitution Lemma)**

对于任意公式 $\phi, \delta \in \mathcal{L}$ 和任意命题变量 $p \in P$，以下三个等式同时成立：

1. 若 $\phi\{p \mapsto \delta\}$ 的计算**不涉及**重命名，则
$\text{Var}(\phi\{p \mapsto \delta\}) = (\text{Var}(\phi) \setminus \{p\}) \cup \text{Var}(\delta)$ (当 $p \in \text{Var}(\phi)$)。
若计算**涉及**重命名 $\sigma: C \to C'$，则
$\text{Var}(\phi\{p \mapsto \delta\}) = (\text{Var}(\phi) \setminus (\{p\} \cup C)) \cup \text{Var}(\delta) \cup C'$ (当 $p \in \text{Var}(\phi)$)。

2.  $\text{Interface}(\phi\{p \mapsto \delta\}) = \begin{cases} (\text{Interface}(\phi) \setminus \{p\}) \cup \text{Interface}(\delta) & \text{若 } p \in \text{Interface}(\phi) \\ \text{Interface}(\phi) & \text{若 } p \notin \text{Interface}(\phi) \end{cases}$

3. $M_{\phi\{p \mapsto \delta\}}$ 的值由以下归纳定义确定：
    *   若 $\phi = q \in P$ (命题变量):
        $$ M_{q\{p \mapsto \delta\}} = \begin{cases} M_\delta & \text{若 } q = p \\ \emptyset & \text{若 } q \neq p \end{cases} $$
    *   若 $\phi = \alpha \mathbf{2} \beta$:
        $$ M_{(\alpha \mathbf{2} \beta)\{p \mapsto \delta\}} = M_{\alpha\{p \mapsto \delta\}} \cup M_{\beta\{p \mapsto \delta\}} $$
    *   若 $\phi = \alpha \mathbf{1} \beta$:
        令 $\phi' = (\alpha \mathbf{1} \beta)\{p \mapsto \delta\}$。令其直接子成分为 $\alpha^*$ 和 $\beta^*$（根据定义 3.2.2，$\alpha^*$ 和 $\beta^*$ 可能是替换或重命名后的版本）。则：
        $$ M_{\phi'} = (V_{\alpha^*} \setminus V_{\beta^*}) \times (V_{\beta^*} \setminus V_{\alpha^*}) $$
        其中 $V_{\alpha^*}$ 和 $V_{\beta^*}$ 分别是 $⟦\alpha^*⟧$ 和 $⟦\beta^*⟧$ 的接口变量集。

**证明**:

本证明采用对合式公式 $\phi$ 的结构进行归纳的方法。在每个归纳步骤中，我们将同时证明上述三个论断。

1.  **基础情况**: 设 $\phi = q$，其中 $q \in P$。

    *   **情况 A**: $q = p$。
        此时 $\phi\{p \mapsto \delta\} = \delta$。同时，我们有 $p \in \text{Var}(\phi) = \{p\}$ 和 $p \in \text{Interface}(\phi) = \{p\}$。
        1.  **论断 1 (Var)**:
            *   左侧 (LHS): $\text{Var}(\phi\{p \mapsto \delta\}) = \text{Var}(\delta)$。
            *   右侧 (RHS): 由于 $p \in \text{Var}(\phi)$，应用第一种情况：$(\text{Var}(\phi) \setminus \{p\}) \cup \text{Var}(\delta) = (\{p\} \setminus \{p\}) \cup \text{Var}(\delta) = \emptyset \cup \text{Var}(\delta) = \text{Var}(\delta)$。
            *   LHS = RHS。
        2.  **论断 2 (Interface)**:
            *   LHS: $\text{Interface}(\phi\{p \mapsto \delta\}) = \text{Interface}(\delta)$。
            *   RHS: 由于 $p \in \text{Interface}(\phi)$，应用第一种情况：$(\text{Interface}(\phi) \setminus \{p\}) \cup \text{Interface}(\delta) = (\{p\} \setminus \{p\}) \cup \text{Interface}(\delta) = \text{Interface}(\delta)$。
            *   LHS = RHS。
        3.  **论断 3 (Mapping)**:
		     *   **情况 A ($q=p$)**:
		               *   LHS: $M_{\phi\{p \mapsto \delta\}} = M_{\delta}$。
		         *   RHS: 根据论断 3 的定义，当 $\phi=p$ 时，$M_{p\{p \mapsto \delta\}} = M_\delta$。
		         *   LHS = RHS。
		     *   **情况 B ($q \neq p$)**:
		         *   LHS: $M_{\phi\{p \mapsto \delta\}} = M_q = \emptyset$。
		         *   RHS: 根据论断 3 的定义，当 $\phi=q \neq p$ 时，$M_{q\{p \mapsto \delta\}} = \emptyset$。
		         *   LHS = RHS。
		     论断成立。

    *   **情况 B**: $q \neq p$。
        此时 $\phi\{p \mapsto \delta\} = q$。同时，我们有 $p \notin \text{Var}(\phi) = \{q\}$ 和 $p \notin \text{Interface}(\phi) = \{q\}$。
        1.  **论断 1 (Var)**:
            *   LHS: $\text{Var}(\phi\{p \mapsto \delta\}) = \text{Var}(q) = \{q\}$。
            *   RHS: 由于 $p \notin \text{Var}(\phi)$，应用第二种情况：$\text{Var}(\phi) = \{q\}$。
            *   LHS = RHS。
        2.  **论断 2 (Interface)**:
            *   LHS: $\text{Interface}(\phi\{p \mapsto \delta\}) = \text{Interface}(q) = \{q\}$。
            *   RHS: 由于 $p \notin \text{Interface}(\phi)$，应用第二种情况：$\text{Interface}(\phi) = \{q\}$。
            *   LHS = RHS。
        3.  **论断 3 (Mapping)**:
            *   LHS: $M_{\phi\{p \mapsto \delta\}} = M_q = \emptyset$。
            *   RHS: 对 $⟦q⟧$ 进行关于 $p$ 的替换，由于 $p$ 未出现，操作是同一的，结果为 $⟦q⟧$。因此链接映射为 $M_q = \emptyset$。
            *   论断成立。

    基础情况得证。

4.  **归纳假设**: 假设对于任意合式公式 $\alpha, \beta \in \mathcal{L}$，定理 S2 的三个论断均成立。

5.  **归纳步骤**: 设 $\phi' = \phi\{p \mapsto \delta\}$。

    *   **情况 i**: 设 $\phi = \alpha \mathbf{2} \beta$。
        根据定义 3.2.2，$\phi' = (\alpha\{p \mapsto \delta\}) \mathbf{2} (\beta\{p \mapsto \delta\})$。我们记 $\alpha' = \alpha\{p \mapsto \delta\}$ 和 $\beta' = \beta\{p \mapsto \delta\}$。
        1.  **论断 1 (Var)**:
            *   LHS: $\text{Var}(\phi') = \text{Var}(\alpha' \mathbf{2} \beta') = \text{Var}(\alpha') \cup \text{Var}(\beta')$。
            *   RHS: 我们需要证明 $\text{Var}(\alpha') \cup \text{Var}(\beta')$ 等于定理中给出的表达式。这需要分情况讨论 $p$ 与 $\text{Var}(\phi)$ 的关系。
				*   **情况 1.1: $p \in \text{Var}(\phi) = \text{Var}(\alpha) \cup \text{Var}(\beta)$。**
				    此时，RHS 的目标表达式为 $(\text{Var}(\phi) \setminus \{p\}) \cup \text{Var}(\delta)$。
				    我们根据归纳假设展开 LHS: $\text{Var}(\alpha') \cup \text{Var}(\beta')$。
				    *   **子情况 1.1.1: $p \in \text{Var}(\alpha)$ 且 $p \in \text{Var}(\beta)$。**
				        根据归纳假设：
				        $\text{Var}(\alpha') = (\text{Var}(\alpha) \setminus \{p\}) \cup \text{Var}(\delta)$
				        $\text{Var}(\beta') = (\text{Var}(\beta) \setminus \{p\}) \cup \text{Var}(\delta)$
				        LHS = $((\text{Var}(\alpha) \setminus \{p\}) \cup \text{Var}(\delta)) \cup ((\text{Var}(\beta) \setminus \{p\}) \cup \text{Var}(\delta))$
				        $= (\text{Var}(\alpha) \setminus \{p\}) \cup (\text{Var}(\beta) \setminus \{p\}) \cup \text{Var}(\delta)$
				        $= ((\text{Var}(\alpha) \cup \text{Var}(\beta)) \setminus \{p\}) \cup \text{Var}(\delta) = (\text{Var}(\phi) \setminus \{p\}) \cup \text{Var}(\delta)$。LHS = RHS。
				    *   **子情况 1.1.2: $p \in \text{Var}(\alpha)$ 且 $p \notin \text{Var}(\beta)$。**
				        根据归纳假设：
				        $\text{Var}(\alpha') = (\text{Var}(\alpha) \setminus \{p\}) \cup \text{Var}(\delta)$
				        $\text{Var}(\beta') = \text{Var}(\beta)$
				        LHS = $((\text{Var}(\alpha) \setminus \{p\}) \cup \text{Var}(\delta)) \cup \text{Var}(\beta)$
				        $= ((\text{Var}(\alpha) \setminus \{p\}) \cup \text{Var}(\beta)) \cup \text{Var}(\delta)$
				        由于 $p \notin \text{Var}(\beta)$, $(\text{Var}(\alpha) \setminus \{p\}) \cup \text{Var}(\beta) = (\text{Var}(\alpha) \cup \text{Var}(\beta)) \setminus \{p\}$。
				        因此，LHS $= (\text{Var}(\phi) \setminus \{p\}) \cup \text{Var}(\delta)$。LHS = RHS。
				    *   **子情况 1.1.3: $p \notin \text{Var}(\alpha)$ 且 $p \in \text{Var}(\beta)$。**
				        此情况与 1.1.2 对称，同样可得 LHS = RHS。
				
				*   **情况 1.2: $p \notin \text{Var}(\phi) = \text{Var}(\alpha) \cup \text{Var}(\beta)$。**
				    这意味着 $p \notin \text{Var}(\alpha)$ 且 $p \notin \text{Var}(\beta)$。此时，RHS 的目标表达式为 $\text{Var}(\phi)$。
				    根据归纳假设：
				    $\text{Var}(\alpha') = \text{Var}(\alpha)$
				    $\text{Var}(\beta') = \text{Var}(\beta)$
				    LHS = $\text{Var}(\alpha') \cup \text{Var}(\beta') = \text{Var}(\alpha) \cup \text{Var}(\beta) = \text{Var}(\phi)$。LHS = RHS。
				
				 在所有情况下，LHS = RHS。论断 1 成立。 
		1.  **论断 2 (Interface)**: 
			LHS: $\text{Interface}(\phi') = \text{Interface}(\alpha' \mathbf{2} \beta') = \text{Interface}(\alpha') \cup \text{Interface}(\beta')$。
			证明过程与论断 1 的证明完全并行，因为算子 $\mathbf{2}$ 对 $\text{Var}$ 和 $\text{Interface}$ 的语义/句法定义均使用并集 $\cup$ 运算。我们将完整地重现该逻辑：
			
			*   **情况 2.1: $p \in \text{Interface}(\phi) = \text{Interface}(\alpha) \cup \text{Interface}(\beta)$。**
			    RHS 目标为 $(\text{Interface}(\phi) \setminus \{p\}) \cup \text{Interface}(\delta)$。
			    *   若 $p \in \text{Interface}(\alpha)$ 且 $p \in \text{Interface}(\beta)$:
			        LHS = $((\text{Interface}(\alpha) \setminus \{p\}) \cup \text{Interface}(\delta)) \cup ((\text{Interface}(\beta) \setminus \{p\}) \cup \text{Interface}(\delta))$
			        $= ((\text{Interface}(\alpha) \cup \text{Interface}(\beta)) \setminus \{p\}) \cup \text{Interface}(\delta)$ = RHS。
			    *   若 $p \in \text{Interface}(\alpha)$ 且 $p \notin \text{Interface}(\beta)$:
			        LHS = $((\text{Interface}(\alpha) \setminus \{p\}) \cup \text{Interface}(\delta)) \cup \text{Interface}(\beta)$
			        $= ((\text{Interface}(\alpha) \cup \text{Interface}(\beta)) \setminus \{p\}) \cup \text{Interface}(\delta)$ = RHS。
			    *   $p \notin \text{Interface}(\alpha)$ 且 $p \in \text{Interface}(\beta)$ 的情况对称。
			
			*   **情况 2.2: $p \notin \text{Interface}(\phi)$。**
			    RHS 目标为 $\text{Interface}(\phi)$。
			    此时 $p \notin \text{Interface}(\alpha)$ 且 $p \notin \text{Interface}(\beta)$。
			    根据归纳假设, $\text{Interface}(\alpha') = \text{Interface}(\alpha)$ 且 $\text{Interface}(\beta') = \text{Interface}(\beta)$。
			    LHS = $\text{Interface}(\alpha) \cup \text{Interface}(\beta) = \text{Interface}(\phi)$ = RHS。
			
			论断 2 成立。
        2.  **论断 3 (Mapping)**:
			 *   LHS: 根据定义 3.2.2，$\phi' = \alpha' \mathbf{2} \beta'$。根据定义 2.3.2 (语义函数)，其链接映射为 $M_{\phi'} = M_{\alpha' \mathbf{2} \beta'} = M_{\alpha'} \cup M_{\beta'}$。
			 *   RHS: 根据论断 3 中针对 `alpha 2 beta` 形式的定义，其断言为 $M_{(\alpha \mathbf{2} \beta)\{p \mapsto \delta\}} = M_{\alpha\{p \mapsto \delta\}} \cup M_{\beta\{p \mapsto \delta\}}$。
			 *   由于我们已记 $\alpha' = \alpha\{p \mapsto \delta\}$ 和 $\beta' = \beta\{p \mapsto \delta\}$，故 LHS = $M_{\alpha'} \cup M_{\beta'}$ 可以重写为 $M_{\alpha\{p \mapsto \delta\}} \cup M_{\beta\{p \mapsto \delta\}}$，这与 RHS 的表达式完全相同。
			 *   LHS = RHS。论断成立。

    *   **情况 ii**: 设 $\phi = \alpha \mathbf{1} \beta$。替换的定义（3.2.2）区分了不同情况。
        *   **子情况 A: $p \notin B(\phi)$ (p 不是绑定变量)**。
            $\phi' = (\alpha\{p \mapsto \delta\}) \mathbf{1} (\beta\{p \mapsto \delta\}) = \alpha' \mathbf{1} \beta'$。此情况下的证明逻辑与算子 $\mathbf{2}$ 的情况非常相似，只需将相应的组合规则（$\cup$ 换为 $\cap$ 或 $\times$）代入即可。
            1.  **论断 1 (Var)**: 与情况 i 的证明同构。
            2.  **论断 2 (Interface)**:
                LHS: $\text{Interface}(\phi') = \text{Interface}(\alpha') \cap \text{Interface}(\beta')$。
                若 $p \in \text{Interface}(\phi) = \text{Interface}(\alpha) \cap \text{Interface}(\beta)$，则 $p$ 同时属于 $\text{Interface}(\alpha)$ 和 $\text{Interface}(\beta)$。根据归纳假设，$\text{Interface}(\alpha') = (\text{Interface}(\alpha) \setminus \{p\}) \cup \text{Interface}(\delta)$，$\beta'$ 同理。LHS = $((\text{Interface}(\alpha) \setminus \{p\}) \cup \text{Interface}(\delta)) \cap ((\text{Interface}(\beta) \setminus \{p\}) \cup \text{Interface}(\delta))$。根据集合分配律，此式等于 $((\text{Interface}(\alpha) \cap \text{Interface}(\beta)) \setminus \{p\}) \cup \text{Interface}(\delta)$, 即 RHS。

		     若 $p \notin \text{Interface}(\phi) = \text{Interface}(\alpha) \cap \text{Interface}(\beta)$，RHS 的目标为 $\text{Interface}(\phi)$。
		     我们结合子情况 A 的核心前提：$p \notin B(\phi) = (\text{Interface}(\alpha) \setminus \text{Interface}(\beta)) \cup (\text{Interface}(\beta) \setminus \text{Interface}(\alpha))$。
		    
		     *   **可能性 1**: $p \in \text{Interface}(\alpha)$ 且 $p \notin \text{Interface}(\beta)$。
		         这意味着 $p \in \text{Interface}(\alpha) \setminus \text{Interface}(\beta)$，即 $p \in B_L(\phi)$。这直接与子情况 A 的前提 $p \notin B(\phi)$ 相矛盾。故此可能性被排除。
		     *   **可能性 2**: $p \notin \text{Interface}(\alpha)$ 且 $p \in \text{Interface}(\beta)$。
		         这意味着 $p \in \text{Interface}(\beta) \setminus \text{Interface}(\alpha)$，即 $p \in B_R(\phi)$。这也与前提 $p \notin B(\phi)$ 相矛盾。故此可能性被排除。
		     *   **可能性 3**: $p \in \text{Interface}(\alpha)$ 且 $p \in \text{Interface}(\beta)$。
		         这意味着 $p \in \text{Interface}(\alpha) \cap \text{Interface}(\beta) = \text{Interface}(\phi)$。这与本小节的假设 $p \notin \text{Interface}(\phi)$ 相矛盾。故此可能性被排除。
		    
		     唯一剩下的可能性是 **$p \notin \text{Interface}(\alpha)$ 且 $p \notin \text{Interface}(\beta)$**。
		     在此情况下，根据归纳假设（论断 2 的第二种情况），我们有：
		     $\text{Interface}(\alpha') = \text{Interface}(\alpha\{p \mapsto \delta\}) = \text{Interface}(\alpha)$
		     $\text{Interface}(\beta') = \text{Interface}(\beta\{p \mapsto \delta\}) = \text{Interface}(\beta)$
		     因此，LHS = $\text{Interface}(\alpha') \cap \text{Interface}(\beta') = \text{Interface}(\alpha) \cap \text{Interface}(\beta) = \text{Interface}(\phi)$。
		     LHS = RHS。论断成立。


			 3.  **论断 3 (Mapping)**:
			     *   LHS: 在此子情况中，$\phi' = \alpha' \mathbf{1} \beta'$。根据定义 2.3.3 (语义函数)，其链接映射为 $M_{\phi'} = (V_{\alpha'} \setminus V_{\beta'}) \times (V_{\beta'} \setminus V_{\alpha'})$。
			     *   RHS: 根据论断 3 中针对 `alpha 1 beta` 形式的定义，其断言为 $M_{\phi'} = (V_{\alpha^*} \setminus V_{\beta^*}) \times (V_{\beta^*} \setminus V_{\alpha^*})$，其中 $\alpha^*$ 和 $\beta^*$ 是 $\phi'$ 的直接子成分。
			     *   在此子情况 A 中，$\alpha^* = \alpha' = \alpha\{p \mapsto \delta\}$ 且 $\beta^* = \beta' = \beta\{p \mapsto \delta\}$。将此代入 RHS 的定义，得到 $(V_{\alpha'} \setminus V_{\beta'}) \times (V_{\beta'} \setminus V_{\alpha'})$，这与 LHS 的表达式完全相同。
			     *   LHS = RHS。论断成立。

        *   **子情况 B: $p \in B_L(\phi) = \text{Interface}(\alpha) \setminus \text{Interface}(\beta)$**。
            这意味着 $p \in \text{Interface}(\alpha)$ 且 $p \notin \text{Interface}(\beta)$。根据替换定义，$\phi' = (\alpha\{p \mapsto \delta\}) \mathbf{1} \beta''$，其中 $\beta''$ 是 $\beta$ 经过必要重命名 $\sigma$ 后的结果 $\beta' = \beta\{\sigma\}$ 以避免变量捕获。
			 1.  **论断 1 (Var)**:
			     此情况 $p \in \text{Var}(\phi)$。若冲突集 $C = \text{Var}(\delta) \cap B_R(\phi) = \emptyset$（无重命名），则目标 RHS 为 $(\text{Var}(\phi) \setminus \{p\}) \cup \text{Var}(\delta)$。若 $C \neq \emptyset$（有重命名），则目标 RHS 为 $(\text{Var}(\phi) \setminus (\{p\} \cup C)) \cup \text{Var}(\delta) \cup C'$。我们直接证明更一般化的重命名情况。
			
			     *   LHS: $\text{Var}(\phi') = \text{Var}((\alpha\{p \mapsto \delta\}) \mathbf{1} \beta'') = \text{Var}(\alpha\{p \mapsto \delta\}) \cup \text{Var}(\beta'')$。
			     *   分析各部分：
			         *   由于 $p \in \text{Interface}(\alpha) \subseteq \text{Var}(\alpha)$，根据归纳假设（论断 1，无重命名情况），我们有：
			             $\text{Var}(\alpha\{p \mapsto \delta\}) = (\text{Var}(\alpha) \setminus \{p\}) \cup \text{Var}(\delta)$。
			         *   $\beta'' = \beta\{\sigma\}$ 是对 $\beta$ 进行重命名 $\sigma: C \to C'$。通过对 $|C|$ 进行简单归纳，可证 $\text{Var}(\beta\{\sigma\}) = (\text{Var}(\beta) \setminus C) \cup C'$。
			     *   合并得到：
			         LHS = $((\text{Var}(\alpha) \setminus \{p\}) \cup \text{Var}(\delta)) \cup ((\text{Var}(\beta) \setminus C) \cup C')$
			             $= (\text{Var}(\alpha) \setminus \{p\}) \cup (\text{Var}(\beta) \setminus C) \cup \text{Var}(\delta) \cup C'$。
			
			     *   现在我们对 RHS 进行代数变形：
			         RHS = $(\text{Var}(\phi) \setminus (\{p\} \cup C)) \cup \text{Var}(\delta) \cup C'$
			             $= ((\text{Var}(\alpha) \cup \text{Var}(\beta)) \setminus (\{p\} \cup C)) \cup \text{Var}(\delta) \cup C'$
			             $= ((\text{Var}(\alpha) \setminus (\{p\} \cup C)) \cup (\text{Var}(\beta) \setminus (\{p\} \cup C))) \cup \text{Var}(\delta) \cup C'$ (分配律)。
			     *   我们利用已知条件简化此表达式：
			         *   $p \in B_L(\phi) \implies p \notin \text{Var}(\beta)$。因此 $(\text{Var}(\beta) \setminus (\{p\} \cup C)) = (\text{Var}(\beta) \setminus C)$。
			         *   $C \subseteq B_R(\phi) = \text{Interface}(\beta) \setminus \text{Interface}(\alpha)$。这意味着 $C \cap \text{Interface}(\alpha) = \emptyset$，进而 $C \cap \text{Var}(\alpha) = \emptyset$。因此 $(\text{Var}(\alpha) \setminus (\{p\} \cup C)) = (\text{Var}(\alpha) \setminus \{p\})$。
			     *   将简化后的部分代回 RHS：
			         RHS = $((\text{Var}(\alpha) \setminus \{p\}) \cup (\text{Var}(\beta) \setminus C)) \cup \text{Var}(\delta) \cup C'$。
			
			     *   比较可知，LHS = RHS。论断 1 成立。无重命名的情况是 $C=\emptyset, C'=\emptyset$ 的特例，同样成立。
            1. **论断 2 (Interface)**:
			     由于 $p \in \text{Interface}(\alpha) \setminus \text{Interface}(\beta)$，可知 $p \notin \text{Interface}(\alpha) \cap \text{Interface}(\beta) = \text{Interface}(\phi)$。因此，RHS 的目标表达式为 $\text{Interface}(\phi)$。
			    
			     LHS = $\text{Interface}(\phi') = \text{Interface}(\alpha\{p \mapsto \delta\}) \cap \text{Interface}(\beta'')$。
			    
			     根据归纳假设（$p \in \text{Interface}(\alpha)$）：
			     $\text{Interface}(\alpha\{p \mapsto \delta\}) = (\text{Interface}(\alpha) \setminus \{p\}) \cup \text{Interface}(\delta)$。
			    
			     对于 $\text{Interface}(\beta'')$，重命名 $\sigma: C \to C'$ 的效果是：
			     $\text{Interface}(\beta'') = (\text{Interface}(\beta) \setminus C) \cup C'$。
			    
			     代入 LHS:
			     LHS = $((\text{Interface}(\alpha) \setminus \{p\}) \cup \text{Interface}(\delta)) \cap ((\text{Interface}(\beta) \setminus C) \cup C')$
			    
			     应用集合分配律展开：
			     LHS = $[((\text{Interface}(\alpha) \setminus \{p\}) \cap (\text{Interface}(\beta) \setminus C))] \cup$
			            $[((\text{Interface}(\alpha) \setminus \{p\}) \cap C')] \cup$
			            $[(\text{Interface}(\delta) \cap (\text{Interface}(\beta) \setminus C))] \cup$
			            $[(\text{Interface}(\delta) \cap C')]$
			     
			     我们逐项分析：
			    *   **第一项**: $(\text{Interface}(\alpha) \setminus \{p\}) \cap (\text{Interface}(\beta) \setminus C)$。
			        由于 $p \notin \text{Interface}(\beta)$ 且 $C \subseteq \text{Interface}(\beta) \setminus \text{Interface}(\alpha)$ 故 $C \cap \text{Interface}(\alpha) = \emptyset$。
			        因此，该表达式简化为 $\text{Interface}(\alpha) \cap \text{Interface}(\beta) = \text{Interface}(\phi)$。
			    *   **第二项**: $(\text{Interface}(\alpha) \setminus \{p\}) \cap C'$。
			        根据重命名规则，新变量 $C'$ 被选择为不出现于 $\text{Var}(\alpha) \cup \text{Var}(\beta) \cup \text{Var}(\delta)$ 中。因此 $C' \cap \text{Var}(\alpha) = \emptyset$，进而 $C' \cap \text{Interface}(\alpha) = \emptyset$。此项为空集 $\emptyset$。
			    *   **第四项**: $\text{Interface}(\delta) \cap C'$。
			        同理，新变量 $C'$ 不出现于 $\text{Var}(\delta)$ 中，故 $C' \cap \text{Interface}(\delta) = \emptyset$。此项为空集 $\emptyset$。
			    *   **第三项**: $\text{Interface}(\delta) \cap (\text{Interface}(\beta) \setminus C)$。
			        我们需要证明此项是第一项 $\text{Interface}(\phi)$ 的子集。
			        令任意变量 $x \in \text{Interface}(\delta) \cap (\text{Interface}(\beta) \setminus C)$。
			        这意味着 $x \in \text{Interface}(\delta)$ 且 $x \in \text{Interface}(\beta)$ 且 $x \notin C$。
			        回顾冲突集定义 $C = \text{Var}(\delta) \cap B_R(\phi) = \text{Var}(\delta) \cap (\text{Interface}(\beta) \setminus \text{Interface}(\alpha))$。
			        我们已知 $x \in \text{Var}(\delta)$ (因为 $\text{Interface}(\delta) \subseteq \text{Var}(\delta)$) 且 $x \in \text{Interface}(\beta)$。
			        如果 $x \notin \text{Interface}(\alpha)$，那么 $x$ 将同时满足在 $\text{Var}(\delta)$ 中和在 $\text{Interface}(\beta) \setminus \text{Interface}(\alpha)$ 中，这将导致 $x \in C$。但这与 $x \notin C$ 的前提矛盾。
			        因此，唯一的可能性是 $x \in \text{Interface}(\alpha)$。
			        既然 $x \in \text{Interface}(\alpha)$ 且 $x \in \text{Interface}(\beta)$，那么根据定义 $x \in \text{Interface}(\alpha) \cap \text{Interface}(\beta) = \text{Interface}(\phi)$。
			        所以，第三项集合是第一项集合 $\text{Interface}(\phi)$ 的一个子集。
			
			     综上，LHS = $\text{Interface}(\phi) \cup \emptyset \cup (\text{一个}\text{Interface}(\phi)\text{的子集}) \cup \emptyset = \text{Interface}(\phi)$。
			     LHS = RHS。论断 2 成立。
			1.  **论断 3 (Mapping)**:
			     *   LHS: 在此子情况中，$\phi' = (\alpha\{p \mapsto \delta\}) \mathbf{1} \beta'' = \alpha' \mathbf{1} \beta''$。根据定义 2.3.3 (语义函数)，其链接映射为 $M_{\phi'} = (V_{\alpha'} \setminus V_{\beta''}) \times (V_{\beta''} \setminus V_{\alpha'})$。
			     *   RHS: 根据论断 3 中针对 `alpha 1 beta` 形式的定义，其断言为 $M_{\phi'} = (V_{\alpha^*} \setminus V_{\beta^*}) \times (V_{\beta^*} \setminus V_{\alpha^*})$，其中 $\alpha^*$ 和 $\beta^*$ 是 $\phi'$ 的直接子成分。
			     *   在此子情况 B 中，$\phi'$ 的直接子成分为 $\alpha^* = \alpha' = \alpha\{p \mapsto \delta\}$ 和 $\beta^* = \beta''$ (其中 $\beta''$ 是经过重命名的 $\beta$）。将此代入 RHS 的定义，得到 $(V_{\alpha'} \setminus V_{\beta''}) \times (V_{\beta''} \setminus V_{\alpha'})$，这与 LHS 的表达式完全相同。归纳假设确保了计算 $V_{\alpha'}$ 和 $V_{\beta''}$ 所依赖的子问题是正确的。
			     *   LHS = RHS。论断成立。


        *   **子情况 C: $p \in B_R(\phi) = \text{Interface}(\beta) \setminus \text{Interface}(\alpha)$**。
            此情况与子情况 B 完全对称。替换只作用于 $\beta$，并可能重命名 $\alpha$ 中的变量。其证明的每一步都与子情况 B 的论证对偶，故此处从略。

综上所述，所有基础情况和归纳步骤均已得证。根据结构归纳原理，该定理对所有合式公式 $\phi \in \mathcal{L}$ 均成立。

□

---

## **6. 可靠性定理 (Reliability Theorem)**

本节将证明公理系统 $\mathcal{H}_{Link}$ 的一个核心元逻辑属性：可靠性。可靠性确保了系统中的任何可证判断都对应着一个语义上的真理。具体而言，任何可被证明为等价的两个公式，其语义值必然是相同的。

#### **引理 6.1: 语义不变性引理 (Semantic Invariance Lemma)**

若两个公式 $\phi$ 和 $\psi$ 在语义上是等价的，即 $⟦\phi⟧ = ⟦\psi⟧$，则对于任意命题变量 $p \in P$ 和任意公式 $\delta \in \mathcal{L}$，对它们进行相同的无捕获替换后，其结果在语义上仍然是等价的。即：
$$ \text{若 } ⟦\phi⟧ = ⟦\psi⟧, \text{ 则 } ⟦\phi\{p \mapsto \delta\}⟧ = ⟦\psi\{p \mapsto \delta\}⟧ $$

**证明**:

本证明的核心是应用 **替换引理 (S2)**。该引理精确地描述了替换操作如何作用于一个公式的语义值。根据定义 2.1，要证明两个语义值相等，我们必须证明它们对应的三个分量——接口变量集 ($V$)、总变量集 ($\text{Var}$) 和链接映射 ($M$)——分别相等。

我们已知的前提是 $⟦\phi⟧ = ⟦\psi⟧$，这意味着：
1.  $V_\phi = V_\psi$
2.  $\text{Var}_\phi = \text{Var}_\psi$
3.  $M_\phi = M_\psi$

我们将分别证明替换后公式的三个语义分量也是相等的。

**1. 证明总变量集相等: $\text{Var}_{\phi\{p \mapsto \delta\}} = \text{Var}_{\psi\{p \mapsto \delta\}}$**

替换引理 (S2, 论断 1) 提供了计算替换后公式总变量集的公式。其选择哪个具体公式，取决于 $p$ 是否在原公式的总变量集中，以及替换是否导致重命名。
*   由于 $\text{Var}_\phi = \text{Var}_\psi$，所以条件 "$p \in \text{Var}_\phi$" 与 "$p \in \text{Var}_\psi$" 是等价的。这意味着在计算 $\text{Var}_{\phi\{p \mapsto \delta\}}$ 和 $\text{Var}_{\psi\{p \mapsto \delta\}}$ 时，我们将使用 S2.1 中的相同情况。
*   重命名冲突集 $C$ 的计算依赖于 $\text{Var}(\delta)$ 和绑定变量集 $B(\phi)$（或 $B(\psi)$）。而绑定变量集 $B(\phi)$ 是通过句法函数 $\text{Interface}(\phi)$ 定义的。根据 **接口函数对应引理 (S1)**，$\text{Interface}(\phi) = V_\phi$。因为 $V_\phi=V_\psi$，所以 $\text{Interface}(\phi) = \text{Interface}(\psi)$，进而 $B(\phi) = B(\psi)$。
*   因此，替换 $\phi\{p \mapsto \delta\}$ 和 $\psi\{p \mapsto \delta\}$ 会遇到完全相同的冲突条件并触发完全相同的重命名（如果需要）。
*   由于计算 $\text{Var}_{\phi\{p \mapsto \delta\}}$ 和 $\text{Var}_{\psi\{p \mapsto \delta\}}$ 的所有输入（$\text{Var}_\phi = \text{Var}_\psi$, $\text{Var}_\delta$, $p$, 及重命名变量）都是相同的，其计算结果必然相同。

**2. 证明接口变量集相等: $V_{\phi\{p \mapsto \delta\}} = V_{\psi\{p \mapsto \delta\}}$**

根据引理 S1，我们只需证明 $\text{Interface}(\phi\{p \mapsto \delta\}) = \text{Interface}(\psi\{p \mapsto \delta\})$。
*   替换引理 (S2, 论断 2) 提供了计算替换后接口变量集的公式。其选择哪个公式取决于 $p$ 是否在原公式的接口变量集中。
*   由于 $V_\phi = V_\psi$，根据引理 S1，有 $\text{Interface}(\phi) = \text{Interface}(\psi)$。因此，条件 "$p \in \text{Interface}(\phi)$" 与 "$p \in \text{Interface}(\psi)$" 是等价的。
*   这意味着在计算 $\text{Interface}(\phi\{p \mapsto \delta\})$ 和 $\text{Interface}(\psi\{p \mapsto \delta\})$ 时，我们将使用 S2.2 中的相同情况。
*   由于计算的所有输入（$\text{Interface}(\phi) = \text{Interface}(\psi)$, $\text{Interface}(\delta)$, $p$）都是相同的，其计算结果必然相同。

**3. 证明链接映射相等: $M_{\phi\{p \mapsto \delta\}} = M_{\psi\{p \mapsto \delta\}}$**

替换引理 (S2, 论断 3) 为 $M_{\phi\{p \mapsto \delta\}}$ 给出了一个归纳定义。我们可以通过对公式 $\phi$ 的结构进行归纳来证明，如果 $⟦\phi⟧ = ⟦\psi⟧$，则 $M_{\phi\{p \mapsto \delta\}} = M_{\psi\{p \mapsto \delta\}}$。
*   **基础情况**: $\phi = q \in P$。若 $⟦q⟧ = ⟦\psi⟧$，则根据 $⟦\cdot⟧$ 的定义，$\psi$ 必须是同一个命题变量 $q$。此情况下，$\phi\{p \mapsto \delta\} = q\{p \mapsto \delta\}$ 且 $\psi\{p \mapsto \delta\} = q\{p \mapsto \delta\}$，因此它们的语义值（包括链接映射）显然相等。
*   **归纳步骤**: 假设 $\phi = \alpha_1 \odot \alpha_2$（其中 $\odot \in \{\mathbf{1}, \mathbf{2}\}$）。若 $⟦\phi⟧ = ⟦\psi⟧$，则根据**唯一可读性定理 (L0)** 及语义定义，$\psi$ 必须具有相同的结构，即 $\psi = \beta_1 \odot \beta_2$，并且其对应子公式的语义值必须相等，即 $⟦\alpha_1⟧ = ⟦\beta_1⟧$ 且 $⟦\alpha_2⟧ = ⟦\beta_2⟧$。
    *   根据归纳假设，我们有 $⟦\alpha_1\{p \mapsto \delta\}⟧ = ⟦\beta_1\{p \mapsto \delta\}⟧$ 和 $⟦\alpha_2\{p \mapsto \delta\}⟧ = ⟦\beta_2\{p \mapsto \delta\}⟧$。这意味着替换后子公式的各语义分量（$V, \text{Var}, M$）均相等。
    *   S2.3 中对 $M_{\phi\{p \mapsto \delta\}}$ 的计算完全依赖于替换后子公式的语义分量。例如，若 $\phi = \alpha_1 \mathbf{2} \alpha_2$，则 $M_{\phi\{p \mapsto \delta\}} = M_{\alpha_1\{p \mapsto \delta\}} \cup M_{\alpha_2\{p \mapsto \delta\}}$。由于 $M_{\alpha_1\{p \mapsto \delta\}} = M_{\beta_1\{p \mapsto \delta\}}$ 且 $M_{\alpha_2\{p \mapsto \delta\}} = M_{\beta_2\{p \mapsto \delta\}}$，显然 $M_{\phi\{p \mapsto \delta\}} = M_{\psi\{p \mapsto \delta\}}$。
    *   算子 $\mathbf{1}$ 的情况同理，其链接映射的计算 $(V_{\alpha^*} \setminus V_{\beta^*}) \times (V_{\beta^*} \setminus V_{\alpha^*})$ 也完全取决于替换后子公式的接口变量集，这些接口变量集根据我们第2部分的证明是相等的。
*   因此，链接映射也必然相等。

综上所述，替换后公式的三个语义分量均相等，故 $⟦\phi\{p \mapsto \delta\}⟧ = ⟦\psi\{p \mapsto \delta\}⟧$。引理证毕。
□

---

#### **定理 6.2: 可靠性 (Reliability)**

对于任意合式公式 $\phi, \psi \in \mathcal{L}$，若 $\vdash \phi \equiv \psi$ 在公理系统 $\mathcal{H}_{Link}$ 中是可证的，则它们的语义值相等，即 $⟦\phi⟧ = ⟦\psi⟧$。
换言之：
$$ \text{若 } \vdash \phi \equiv \psi, \text{ 则 } ⟦\phi⟧ = ⟦\psi⟧ $$

**证明**:

本证明采用对推演序列的长度 $n$ 进行归纳的方法。一个推演序列是一个等式列表 $(\phi_1 \equiv \psi_1, \dots, \phi_n \equiv \psi_n)$，其中最后一个等式 $\phi_n \equiv \psi_n$ 是我们要证明的判断。序列中的每一个等式要么是一个公理的实例，要么是通过应用某条推理规则于序列中先前的等式而得到。

我们的**归纳假设 (IH)** 是：对于所有长度小于 $n$ 的推演所得到的判断 $\vdash \alpha \equiv \beta$，都有 $⟦\alpha⟧ = ⟦\beta⟧$ 成立。

**1. 基础情况 ($n=1$)**

推演的第一个等式 $\vdash \phi \equiv \psi$ 必须是公理 A1 (自反律) 的一个实例，因为 A2 和 A3 是从已有判断生成新判断的模式。
*   **公理 A1 (自反律)**: $\vdash \phi \equiv \phi$。
    我们需要证明 $⟦\phi⟧ = ⟦\phi⟧$。根据元语言中等式的自反性，此结论是平凡为真的。

**2. 归纳步骤 ($n > 1$)**

假设判断 $\vdash \phi \equiv \psi$ 是通过长度为 $n$ 的推演得到的，且其最后一个步骤是应用某条公理模式或推理规则。

*   **公理 A2 (对称律)**: 若 $\vdash \phi \equiv \psi$ 是一个出现在序列中较早位置（推演长度小于 $n$）的判断，则我们可以推断出 $\vdash \psi \equiv \phi$。
    *   根据归纳假设，由 $\vdash \phi \equiv \psi$ 可得 $⟦\phi⟧ = ⟦\psi⟧$。
    *   根据元语言中等式的对称性，若 $⟦\phi⟧ = ⟦\psi⟧$，则 $⟦\psi⟧ = ⟦\phi⟧$。
    *   这正是我们需要为结论 $\vdash \psi \equiv \phi$ 证明的语义属性。

*   **公理 A3 (传递律)**: 若 $\vdash \phi \equiv \psi$ 和 $\vdash \psi \equiv \chi$ 是两个出现在序列中较早位置的判断。
    *   根据归纳假设，我们有 $⟦\phi⟧ = ⟦\psi⟧$ 和 $⟦\psi⟧ = ⟦\chi⟧$。
    *   根据元语言中等式的传递性，可得 $⟦\phi⟧ = ⟦\chi⟧$。
    *   这正是我们需要为结论 $\vdash \phi \equiv \chi$ 证明的语义属性。

*   **公理 A4 (算子 $\mathbf{2}$ 的交换律)**: $\vdash \phi \mathbf{2} \psi \equiv \psi \mathbf{2} \phi$。
    我们需要证明 $⟦\phi \mathbf{2} \psi⟧ = ⟦\psi \mathbf{2} \phi⟧$。令 $⟦\phi⟧ = (V_\phi, \text{Var}_\phi, M_\phi)$ 和 $⟦\psi⟧ = (V_\psi, \text{Var}_\psi, M_\psi)$。
    *   **接口变量集**: 根据定义 2.3.2，$V_{\phi \mathbf{2} \psi} = V_\phi \cup V_\psi$。根据集合并集的交换律，$V_\phi \cup V_\psi = V_\psi \cup V_\phi = V_{\psi \mathbf{2} \phi}$。
    *   **总变量集**: 根据定义 2.3.2，$\text{Var}_{\phi \mathbf{2} \psi} = \text{Var}_\phi \cup \text{Var}_\psi$。根据集合并集的交换律，$\text{Var}_\phi \cup \text{Var}_\psi = \text{Var}_\psi \cup \text{Var}_\phi = \text{Var}_{\psi \mathbf{2} \phi}$。
    *   **链接映射**: 根据定义 2.3.2，$M_{\phi \mathbf{2} \psi} = M_\phi \cup M_\psi$。根据集合并集的交换律，$M_\phi \cup M_\psi = M_\psi \cup M_\phi = M_{\psi \mathbf{2} \phi}$。
    *   由于所有三个语义分量均相等，故 $⟦\phi \mathbf{2} \psi⟧ = ⟦\psi \mathbf{2} \phi⟧$。

*   **公理 A5 (算子 $\mathbf{2}$ 的结合律)**: $\vdash (\phi \mathbf{2} \psi) \mathbf{2} \chi \equiv \phi \mathbf{2} (\psi \mathbf{2} \chi)$。
    我们需要证明 $⟦(\phi \mathbf{2} \psi) \mathbf{2} \chi⟧ = ⟦\phi \mathbf{2} (\psi \mathbf{2} \chi)⟧$。
    *   **接口变量集**: $V_{(\phi \mathbf{2} \psi) \mathbf{2} \chi} = V_{\phi \mathbf{2} \psi} \cup V_\chi = (V_\phi \cup V_\psi) \cup V_\chi$。根据集合并集的结合律，此式等于 $V_\phi \cup (V_\psi \cup V_\chi) = V_\phi \cup V_{\psi \mathbf{2} \chi} = V_{\phi \mathbf{2} (\psi \mathbf{2} \chi)}$。
    *   **总变量集**: $\text{Var}_{(\phi \mathbf{2} \psi) \mathbf{2} \chi} = \text{Var}_{\phi \mathbf{2} \psi} \cup \text{Var}_\chi = (\text{Var}_\phi \cup \text{Var}_\psi) \cup \text{Var}_\chi$。根据集合并集的结合律，此式等于 $\text{Var}_\phi \cup (\text{Var}_\psi \cup \text{Var}_\chi) = \text{Var}_\phi \cup \text{Var}_{\psi \mathbf{2} \chi} = \text{Var}_{\phi \mathbf{2} (\psi \mathbf{2} \chi)}$。
    *   **链接映射**: $M_{(\phi \mathbf{2} \psi) \mathbf{2} \chi} = M_{\phi \mathbf{2} \psi} \cup M_\chi = (M_\phi \cup M_\psi) \cup M_\chi$。根据集合并集的结合律，此式等于 $M_\phi \cup (M_\psi \cup M_\chi) = M_\phi \cup M_{\psi \mathbf{2} \chi} = M_{\phi \mathbf{2} (\psi \mathbf{2} \chi)}$。
    *   由于所有三个语义分量均相等，故 $⟦(\phi \mathbf{2} \psi) \mathbf{2} \chi⟧ = ⟦\phi \mathbf{2} (\psi \mathbf{2} \chi)⟧$。

*   **公理 A6 (算子 $\mathbf{2}$ 的幂等律)**: $\vdash \phi \mathbf{2} \phi \equiv \phi$。
    我们需要证明 $⟦\phi \mathbf{2} \phi⟧ = ⟦\phi⟧$。
    *   **接口变量集**: $V_{\phi \mathbf{2} \phi} = V_\phi \cup V_\phi$。根据集合并集的幂等律，$V_\phi \cup V_\phi = V_\phi$。
    *   **总变量集**: $\text{Var}_{\phi \mathbf{2} \phi} = \text{Var}_\phi \cup \text{Var}_\phi$。根据集合并集的幂等律，$\text{Var}_\phi \cup \text{Var}_\phi = \text{Var}_\phi$。
    *   **链接映射**: $M_{\phi \mathbf{2} \phi} = M_\phi \cup M_\phi$。根据集合并集的幂等律，$M_\phi \cup M_\phi = M_\phi$。
    *   $⟦\phi \mathbf{2} \phi⟧$ 的所有三个语义分量均与 $⟦\phi⟧$ 的相应分量相等，故 $⟦\phi \mathbf{2} \phi⟧ = ⟦\phi⟧$。

*   **公理 A7 (吸收律)**: $\vdash (\phi \mathbf{1} \phi) \mathbf{2} \phi \equiv \phi$。
    我们需要证明 $⟦(\phi \mathbf{1} \phi) \mathbf{2} \phi⟧ = ⟦\phi⟧$。
    令 $⟦\phi⟧ = (V_\phi, \text{Var}_\phi, M_\phi)$。
    首先，计算 $⟦\phi \mathbf{1} \phi⟧$。根据定义 2.3.3：
    *   $V_{\phi \mathbf{1} \phi} = V_\phi \cap V_\phi = V_\phi$
    *   $\text{Var}_{\phi \mathbf{1} \phi} = \text{Var}_\phi \cup \text{Var}_\phi = \text{Var}_\phi$
    *   $M_{\phi \mathbf{1} \phi} = (V_\phi \setminus V_\phi) \times (V_\phi \setminus V_\phi) = \emptyset \times \emptyset = \emptyset$
    故 $⟦\phi \mathbf{1} \phi⟧ = (V_\phi, \text{Var}_\phi, \emptyset)$。
    接下来，计算 $⟦(\phi \mathbf{1} \phi) \mathbf{2} \phi⟧$。根据定义 2.3.2：
    *   $V_{(\phi \mathbf{1} \phi) \mathbf{2} \phi} = V_{\phi \mathbf{1} \phi} \cup V_\phi = V_\phi \cup V_\phi = V_\phi$
    *   $\text{Var}_{(\phi \mathbf{1} \phi) \mathbf{2} \phi} = \text{Var}_{\phi \mathbf{1} \phi} \cup \text{Var}_\phi = \text{Var}_\phi \cup \text{Var}_\phi = \text{Var}_\phi$
    *   $M_{(\phi \mathbf{1} \phi) \mathbf{2} \phi} = M_{\phi \mathbf{1} \phi} \cup M_\phi = \emptyset \cup M_\phi = M_\phi$
    因此，$⟦(\phi \mathbf{1} \phi) \mathbf{2} \phi⟧ = (V_\phi, \text{Var}_\phi, M_\phi) = ⟦\phi⟧$。公理可靠。

*   **公理 A8 (子集交换律)**: $\vdash \phi \mathbf{1} (\phi \mathbf{2} \psi) \equiv (\phi \mathbf{2} \psi) \mathbf{1} \phi$。
    我们需要证明 $⟦\phi \mathbf{1} (\phi \mathbf{2} \psi)⟧ = ⟦(\phi \mathbf{2} \psi) \mathbf{1} \phi⟧$。
    令 $⟦\phi⟧ = (V_\phi, \text{Var}_\phi, M_\phi)$ 和 $⟦\psi⟧ = (V_\psi, \text{Var}_\psi, M_\psi)$。
    首先，计算 $⟦\phi \mathbf{2} \psi⟧$。根据定义 2.3.2:
    $⟦\phi \mathbf{2} \psi⟧ = (V_\phi \cup V_\psi, \text{Var}_\phi \cup \text{Var}_\psi, M_\phi \cup M_\psi)$。
    
    1.  **计算等式左侧 $⟦\phi \mathbf{1} (\phi \mathbf{2} \psi)⟧$**:
        根据定义 2.3.3：
        *   $V_L = V_\phi \cap V_{\phi \mathbf{2} \psi} = V_\phi \cap (V_\phi \cup V_\psi) = V_\phi$。
        *   $\text{Var}_L = \text{Var}_\phi \cup \text{Var}_{\phi \mathbf{2} \psi} = \text{Var}_\phi \cup (\text{Var}_\phi \cup \text{Var}_\psi) = \text{Var}_\phi \cup \text{Var}_\psi$。
        *   $M_L = (V_\phi \setminus V_{\phi \mathbf{2} \psi}) \times (V_{\phi \mathbf{2} \psi} \setminus V_\phi) = (V_\phi \setminus (V_\phi \cup V_\psi)) \times ((V_\phi \cup V_\psi) \setminus V_\phi) = \emptyset \times (V_\psi \setminus V_\phi) = \emptyset$。
        故 $⟦\phi \mathbf{1} (\phi \mathbf{2} \psi)⟧ = (V_\phi, \text{Var}_\phi \cup \text{Var}_\psi, \emptyset)$。

    2.  **计算等式右侧 $⟦(\phi \mathbf{2} \psi) \mathbf{1} \phi⟧$**:
        根据定义 2.3.3：
        *   $V_R = V_{\phi \mathbf{2} \psi} \cap V_\phi = (V_\phi \cup V_\psi) \cap V_\phi = V_\phi$。
        *   $\text{Var}_R = \text{Var}_{\phi \mathbf{2} \psi} \cup \text{Var}_\phi = (\text{Var}_\phi \cup \text{Var}_\psi) \cup \text{Var}_\phi = \text{Var}_\phi \cup \text{Var}_\psi$。
        *   $M_R = (V_{\phi \mathbf{2} \psi} \setminus V_\phi) \times (V_\phi \setminus V_{\phi \mathbf{2} \psi}) = ((V_\phi \cup V_\psi) \setminus V_\phi) \times (V_\phi \setminus (V_\phi \cup V_\psi)) = (V_\psi \setminus V_\phi) \times \emptyset = \emptyset$。
        故 $⟦(\phi \mathbf{2} \psi) \mathbf{1} \phi⟧ = (V_\phi, \text{Var}_\phi \cup \text{Var}_\psi, \emptyset)$。
    
    由于两侧的语义值相等，该公理可靠。

*   **公理 A9 (链接消除的同态律)**: $\vdash (\phi \mathbf{1} \phi) \mathbf{2} (\psi \mathbf{1} \psi) \equiv (\phi \mathbf{2} \psi) \mathbf{1} (\phi \mathbf{2} \psi)$。
    我们需要证明 $⟦(\phi \mathbf{1} \phi) \mathbf{2} (\psi \mathbf{1} \psi)⟧ = ⟦(\phi \mathbf{2} \psi) \mathbf{1} (\phi \mathbf{2} \psi)⟧$。

    1.  **计算等式左侧 $⟦(\phi \mathbf{1} \phi) \mathbf{2} (\psi \mathbf{1} \psi)⟧$**:
        如公理 A7 证明所示，$⟦\phi \mathbf{1} \phi⟧ = (V_\phi, \text{Var}_\phi, \emptyset)$ 且 $⟦\psi \mathbf{1} \psi⟧ = (V_\psi, \text{Var}_\psi, \emptyset)$。
        根据定义 2.3.2：
        *   $V_L = V_{\phi \mathbf{1} \phi} \cup V_{\psi \mathbf{1} \psi} = V_\phi \cup V_\psi$。
        *   $\text{Var}_L = \text{Var}_{\phi \mathbf{1} \phi} \cup \text{Var}_{\psi \mathbf{1} \psi} = \text{Var}_\phi \cup \text{Var}_\psi$。
        *   $M_L = M_{\phi \mathbf{1} \phi} \cup M_{\psi \mathbf{1} \psi} = \emptyset \cup \emptyset = \emptyset$。
        故 $⟦(\phi \mathbf{1} \phi) \mathbf{2} (\psi \mathbf{1} \psi)⟧ = (V_\phi \cup V_\psi, \text{Var}_\phi \cup \text{Var}_\psi, \emptyset)$。

    2.  **计算等式右侧 $⟦(\phi \mathbf{2} \psi) \mathbf{1} (\phi \mathbf{2} \psi)⟧$**:
        令 $\chi = \phi \mathbf{2} \psi$。我们首先计算 $⟦\chi⟧$。
        $⟦\chi⟧ = (V_\phi \cup V_\psi, \text{Var}_\phi \cup \text{Var}_\psi, M_\phi \cup M_\psi)$。
        根据定义 2.3.3，计算 $⟦\chi \mathbf{1} \chi⟧$：
        *   $V_R = V_\chi \cap V_\chi = V_\chi = V_\phi \cup V_\psi$。
        *   $\text{Var}_R = \text{Var}_\chi \cup \text{Var}_\chi = \text{Var}_\chi = \text{Var}_\phi \cup \text{Var}_\psi$。
        *   $M_R = (V_\chi \setminus V_\chi) \times (V_\chi \setminus V_\chi) = \emptyset \times \emptyset = \emptyset$。
        故 $⟦(\phi \mathbf{2} \psi) \mathbf{1} (\phi \mathbf{2} \psi)⟧ = (V_\phi \cup V_\psi, \text{Var}_\phi \cup \text{Var}_\psi, \emptyset)$。

    由于两侧的语义值相等，该公理可靠。

*   **公理 A10 (上下文链接消除律)**: $\vdash \gamma \mathbf{2} (\gamma \mathbf{1} \phi) \equiv \gamma \mathbf{2} (\gamma \mathbf{1} (\phi \mathbf{1} \phi))$。
    我们需要证明 $⟦\gamma \mathbf{2} (\gamma \mathbf{1} \phi)⟧ = ⟦\gamma \mathbf{2} (\gamma \mathbf{1} (\phi \mathbf{1} \phi))⟧$。
    令 $⟦\phi⟧ = (V_\phi, \text{Var}_\phi, M_\phi)$ 和 $⟦\gamma⟧ = (V_\gamma, \text{Var}_\gamma, M_\gamma)$。

    1.  **计算等式左侧 $⟦\gamma \mathbf{2} (\gamma \mathbf{1} \phi)⟧$**:
        *   首先计算 $⟦\gamma \mathbf{1} \phi⟧$。根据定义 2.3.3：
            *   $V_{\gamma \mathbf{1} \phi} = V_\gamma \cap V_\phi$
            *   $\text{Var}_{\gamma \mathbf{1} \phi} = \text{Var}_\gamma \cup \text{Var}_\phi$
            *   $M_{\gamma \mathbf{1} \phi} = (V_\gamma \setminus V_\phi) \times (V_\phi \setminus V_\gamma)$
        *   然后计算 $⟦\gamma \mathbf{2} (\gamma \mathbf{1} \phi)⟧$。根据定义 2.3.2：
            *   $V_{LHS} = V_\gamma \cup V_{\gamma \mathbf{1} \phi} = V_\gamma \cup (V_\gamma \cap V_\phi) = V_\gamma$
            *   $\text{Var}_{LHS} = \text{Var}_\gamma \cup \text{Var}_{\gamma \mathbf{1} \phi} = \text{Var}_\gamma \cup (\text{Var}_\gamma \cup \text{Var}_\phi) = \text{Var}_\gamma \cup \text{Var}_\phi$
            *   $M_{LHS} = M_\gamma \cup M_{\gamma \mathbf{1} \phi} = M_\gamma \cup ((V_\gamma \setminus V_\phi) \times (V_\phi \setminus V_\gamma))$
        *   故 $⟦\gamma \mathbf{2} (\gamma \mathbf{1} \phi)⟧ = (V_\gamma, \text{Var}_\gamma \cup \text{Var}_\phi, M_\gamma \cup ((V_\gamma \setminus V_\phi) \times (V_\phi \setminus V_\gamma)))$。

    2.  **计算等式右侧 $⟦\gamma \mathbf{2} (\gamma \mathbf{1} (\phi \mathbf{1} \phi))⟧$**:
        *   令 $\phi' = \phi \mathbf{1} \phi$。我们在公理 A7 的证明中已知 $⟦\phi'⟧ = (V_\phi, \text{Var}_\phi, \emptyset)$。
        *   首先计算 $⟦\gamma \mathbf{1} \phi'⟧$。根据定义 2.3.3：
            *   $V_{\gamma \mathbf{1} \phi'} = V_\gamma \cap V_{\phi'} = V_\gamma \cap V_\phi$
            *   $\text{Var}_{\gamma \mathbf{1} \phi'} = \text{Var}_\gamma \cup \text{Var}_{\phi'} = \text{Var}_\gamma \cup \text{Var}_\phi$
            *   $M_{\gamma \mathbf{1} \phi'} = (V_\gamma \setminus V_{\phi'}) \times (V_{\phi'} \setminus V_\gamma) = (V_\gamma \setminus V_\phi) \times (V_\phi \setminus V_\gamma)$
        *   然后计算 $⟦\gamma \mathbf{2} (\gamma \mathbf{1} \phi')⟧$。根据定义 2.3.2：
            *   $V_{RHS} = V_\gamma \cup V_{\gamma \mathbf{1} \phi'} = V_\gamma \cup (V_\gamma \cap V_\phi) = V_\gamma$
            *   $\text{Var}_{RHS} = \text{Var}_\gamma \cup \text{Var}_{\gamma \mathbf{1} \phi'} = \text{Var}_\gamma \cup (\text{Var}_\gamma \cup \text{Var}_\phi) = \text{Var}_\gamma \cup \text{Var}_\phi$
            *   $M_{RHS} = M_\gamma \cup M_{\gamma \mathbf{1} \phi'} = M_\gamma \cup ((V_\gamma \setminus V_\phi) \times (V_\phi \setminus V_\gamma))$
        *   故 $⟦\gamma \mathbf{2} (\gamma \mathbf{1} (\phi \mathbf{1} \phi))⟧ = (V_\gamma, \text{Var}_\gamma \cup \text{Var}_\phi, M_\gamma \cup ((V_\gamma \setminus V_\phi) \times (V_\phi \setminus V_\gamma)))$。

    由于两侧的语义值相等，该公理可靠。

*   **公理 A11 (链接逆反湮灭律)**: $\vdash (\alpha \mathbf{1} \beta) \mathbf{1} (\beta \mathbf{1} \alpha) \equiv (\alpha \mathbf{1} \beta) \mathbf{1} (\alpha \mathbf{1} \beta)$。
    我们需要证明 $⟦(\alpha \mathbf{1} \beta) \mathbf{1} (\beta \mathbf{1} \alpha)⟧ = ⟦(\alpha \mathbf{1} \beta) \mathbf{1} (\alpha \mathbf{1} \beta)⟧$。
    令 $⟦\alpha⟧ = (V_\alpha, \text{Var}_\alpha, M_\alpha)$ 和 $⟦\beta⟧ = (V_\beta, \text{Var}_\beta, M_\beta)$。

    1.  **计算等式右侧 $⟦(\alpha \mathbf{1} \beta) \mathbf{1} (\alpha \mathbf{1} \beta)⟧$**:
        *   令 $\chi = \alpha \mathbf{1} \beta$。等式右侧为 $⟦\chi \mathbf{1} \chi⟧$。
        *   我们首先计算 $⟦\chi⟧ = ⟦\alpha \mathbf{1} \beta⟧$。根据定义 2.3.3:
            $⟦\chi⟧ = (V_\alpha \cap V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha))$。
        *   现在计算 $⟦\chi \mathbf{1} \chi⟧$。根据定义 2.3.3:
            *   $V_{RHS} = V_\chi \cap V_\chi = V_\chi = V_\alpha \cap V_\beta$
            *   $\text{Var}_{RHS} = \text{Var}_\chi \cup \text{Var}_\chi = \text{Var}_\chi = \text{Var}_\alpha \cup \text{Var}_\beta$
            *   $M_{RHS} = (V_\chi \setminus V_\chi) \times (V_\chi \setminus V_\chi) = \emptyset \times \emptyset = \emptyset$
        *   故 $⟦(\alpha \mathbf{1} \beta) \mathbf{1} (\alpha \mathbf{1} \beta)⟧ = (V_\alpha \cap V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, \emptyset)$。

    2.  **计算等式左侧 $⟦(\alpha \mathbf{1} \beta) \mathbf{1} (\beta \mathbf{1} \alpha)⟧$**:
        *   令 $\chi_1 = \alpha \mathbf{1} \beta$ 和 $\chi_2 = \beta \mathbf{1} \alpha$。等式左侧为 $⟦\chi_1 \mathbf{1} \chi_2⟧$。
        *   $⟦\chi_1⟧ = (V_\alpha \cap V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha))$。
        *   $⟦\chi_2⟧ = ⟦\beta \mathbf{1} \alpha⟧ = (V_\beta \cap V_\alpha, \text{Var}_\beta \cup \text{Var}_\alpha, (V_\beta \setminus V_\alpha) \times (V_\alpha \setminus V_\beta))$。
        *   我们观察到 $V_{\chi_1} = V_\beta \cap V_\alpha = V_{\chi_2}$ 且 $\text{Var}_{\chi_1} = \text{Var}_\beta \cup \text{Var}_\alpha = \text{Var}_{\chi_2}$。
        *   现在计算 $⟦\chi_1 \mathbf{1} \chi_2⟧$。根据定义 2.3.3:
            *   $V_{LHS} = V_{\chi_1} \cap V_{\chi_2} = V_{\chi_1} = V_\alpha \cap V_\beta$
            *   $\text{Var}_{LHS} = \text{Var}_{\chi_1} \cup \text{Var}_{\chi_2} = \text{Var}_{\chi_1} = \text{Var}_\alpha \cup \text{Var}_\beta$
            *   $M_{LHS} = (V_{\chi_1} \setminus V_{\chi_2}) \times (V_{\chi_2} \setminus V_{\chi_1})$。由于 $V_{\chi_1} = V_{\chi_2}$，该表达式为 $\emptyset \times \emptyset = \emptyset$。
        *   故 $⟦(\alpha \mathbf{1} \beta) \mathbf{1} (\beta \mathbf{1} \alpha)⟧ = (V_\alpha \cap V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, \emptyset)$。

    由于两侧的语义值相等，该公理可靠。

*   **公理 A12 (右侧链接无关律)**: $\vdash \alpha \mathbf{1} \beta \equiv \alpha \mathbf{1} (\beta \mathbf{1} \beta)$。
    我们需要证明 $⟦\alpha \mathbf{1} \beta⟧ = ⟦\alpha \mathbf{1} (\beta \mathbf{1} \beta)⟧$。
    令 $⟦\alpha⟧ = (V_\alpha, \text{Var}_\alpha, M_\alpha)$ 和 $⟦\beta⟧ = (V_\beta, \text{Var}_\beta, M_\beta)$。

    1.  **计算等式左侧 $⟦\alpha \mathbf{1} \beta⟧$**:
        根据定义 2.3.3：
        *   $V_{LHS} = V_\alpha \cap V_\beta$
        *   $\text{Var}_{LHS} = \text{Var}_\alpha \cup \text{Var}_\beta$
        *   $M_{LHS} = (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha)$
        故 $⟦\alpha \mathbf{1} \beta⟧ = (V_\alpha \cap V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha))$。

    2.  **计算等式右侧 $⟦\alpha \mathbf{1} (\beta \mathbf{1} \beta)⟧$**:
        令 $\beta' = \beta \mathbf{1} \beta$。我们首先计算 $⟦\beta'⟧$。根据定义 2.3.3：
        *   $V_{\beta'} = V_\beta \cap V_\beta = V_\beta$
        *   $\text{Var}_{\beta'} = \text{Var}_\beta \cup \text{Var}_\beta = \text{Var}_\beta$
        *   $M_{\beta'} = (V_\beta \setminus V_\beta) \times (V_\beta \setminus V_\beta) = \emptyset \times \emptyset = \emptyset$
        故 $⟦\beta'⟧ = (V_\beta, \text{Var}_\beta, \emptyset)$。
        接下来，我们计算 $⟦\alpha \mathbf{1} \beta'⟧$。根据定义 2.3.3：
        *   $V_{RHS} = V_\alpha \cap V_{\beta'} = V_\alpha \cap V_\beta$
        *   $\text{Var}_{RHS} = \text{Var}_\alpha \cup \text{Var}_{\beta'} = \text{Var}_\alpha \cup \text{Var}_\beta$
        *   $M_{RHS} = (V_\alpha \setminus V_{\beta'}) \times (V_{\beta'} \setminus V_\alpha) = (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha)$
        故 $⟦\alpha \mathbf{1} (\beta \mathbf{1} \beta)⟧ = (V_\alpha \cap V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha))$。

    由于两侧的语义值相等，该公理可靠。

*   **公理 A13 (左侧链接无关律)**: $\vdash \alpha \mathbf{1} \beta \equiv (\alpha \mathbf{1} \alpha) \mathbf{1} \beta$。
    我们需要证明 $⟦\alpha \mathbf{1} \beta⟧ = ⟦(\alpha \mathbf{1} \alpha) \mathbf{1} \beta⟧$。
    令 $⟦\alpha⟧ = (V_\alpha, \text{Var}_\alpha, M_\alpha)$ 和 $⟦\beta⟧ = (V_\beta, \text{Var}_\beta, M_\beta)$。

    1.  **计算等式左侧 $⟦\alpha \mathbf{1} \beta⟧$**:
        $⟦\alpha \mathbf{1} \beta⟧ = (V_\alpha \cap V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha))$。

    2.  **计算等式右侧 $⟦(\alpha \mathbf{1} \alpha) \mathbf{1} \beta⟧$**:
        令 $\alpha' = \alpha \mathbf{1} \alpha$。我们首先计算 $⟦\alpha'⟧$。根据定义 2.3.3：
        *   $V_{\alpha'} = V_\alpha \cap V_\alpha = V_\alpha$
        *   $\text{Var}_{\alpha'} = \text{Var}_\alpha \cup \text{Var}_\alpha = \text{Var}_\alpha$
        *   $M_{\alpha'} = (V_\alpha \setminus V_\alpha) \times (V_\alpha \setminus V_\alpha) = \emptyset \times \emptyset = \emptyset$
        故 $⟦\alpha'⟧ = (V_\alpha, \text{Var}_\alpha, \emptyset)$。
        接下来，我们计算 $⟦\alpha' \mathbf{1} \beta⟧$。根据定义 2.3.3：
        *   $V_{RHS} = V_{\alpha'} \cap V_\beta = V_\alpha \cap V_\beta$
        *   $\text{Var}_{RHS} = \text{Var}_{\alpha'} \cup \text{Var}_\beta = \text{Var}_\alpha \cup \text{Var}_\beta$
        *   $M_{RHS} = (V_{\alpha'} \setminus V_\beta) \times (V_\beta \setminus V_{\alpha'}) = (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha)$
        故 $⟦(\alpha \mathbf{1} \alpha) \mathbf{1} \beta⟧ = (V_\alpha \cap V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha))$。

    由于两侧的语义值相等，该公理可靠。

*   **公理 A14 (链接消除的吸收律)**: $\vdash (\phi \mathbf{1} \phi) \mathbf{1} \phi \equiv \phi \mathbf{1} \phi$。
    我们需要证明 $⟦(\phi \mathbf{1} \phi) \mathbf{1} \phi⟧ = ⟦\phi \mathbf{1} \phi⟧$。
    令 $⟦\phi⟧ = (V_\phi, \text{Var}_\phi, M_\phi)$。

    1.  **计算等式右侧 $⟦\phi \mathbf{1} \phi⟧$**:
        根据定义 2.3.3：
        *   $V_{RHS} = V_\phi \cap V_\phi = V_\phi$
        *   $\text{Var}_{RHS} = \text{Var}_\phi \cup \text{Var}_\phi = \text{Var}_\phi$
        *   $M_{RHS} = (V_\phi \setminus V_\phi) \times (V_\phi \setminus V_\phi) = \emptyset \times \emptyset = \emptyset$
        故 $⟦\phi \mathbf{1} \phi⟧ = (V_\phi, \text{Var}_\phi, \emptyset)$。

    2.  **计算等式左侧 $⟦(\phi \mathbf{1} \phi) \mathbf{1} \phi⟧$**:
        令 $\phi' = \phi \mathbf{1} \phi$。我们已经从右侧的计算中得知 $⟦\phi'⟧ = (V_\phi, \text{Var}_\phi, \emptyset)$。
        现在我们计算 $⟦\phi' \mathbf{1} \phi⟧$。根据定义 2.3.3：
        *   $V_{LHS} = V_{\phi'} \cap V_\phi = V_\phi \cap V_\phi = V_\phi$
        *   $\text{Var}_{LHS} = \text{Var}_{\phi'} \cup \text{Var}_\phi = \text{Var}_\phi \cup \text{Var}_\phi = \text{Var}_\phi$
        *   $M_{LHS} = (V_{\phi'} \setminus V_\phi) \times (V_\phi \setminus V_{\phi'}) = (V_\phi \setminus V_\phi) \times (V_\phi \setminus V_\phi) = \emptyset \times \emptyset = \emptyset$
        故 $⟦(\phi \mathbf{1} \phi) \mathbf{1} \phi⟧ = (V_\phi, \text{Var}_\phi, \emptyset)$。

    由于两侧的语义值相等，该公理可靠。

*   **规则 R1 (算子 $\mathbf{2}$ 的同余规则)**: 规则的前提是 $\vdash \alpha \equiv \alpha'$ 和 $\vdash \beta \equiv \beta'$。结论是 $\vdash \alpha \mathbf{2} \beta \equiv \alpha' \mathbf{2} \beta'$。
    *   根据归纳假设，我们有 $⟦\alpha⟧ = ⟦\alpha'⟧$ 和 $⟦\beta⟧ = ⟦\beta'⟧$。
    *   令 $⟦\alpha⟧ = (V_\alpha, \text{Var}_\alpha, M_\alpha)$ 和 $⟦\beta⟧ = (V_\beta, \text{Var}_\beta, M_\beta)$。则 $⟦\alpha'⟧ = (V_\alpha, \text{Var}_\alpha, M_\alpha)$ 且 $⟦\beta'⟧ = (V_\beta, \text{Var}_\beta, M_\beta)$。
    *   根据算子 $\mathbf{2}$ 的语义定义 (2.3.2):
        $⟦\alpha \mathbf{2} \beta⟧ = (V_\alpha \cup V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, M_\alpha \cup M_\beta)$
    *   同理:
        $⟦\alpha' \mathbf{2} \beta'⟧ = (V_{\alpha'} \cup V_{\beta'}, \text{Var}_{\alpha'} \cup \text{Var}_{\beta'}, M_{\alpha'} \cup M_{\beta'}) = (V_\alpha \cup V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, M_\alpha \cup M_\beta)$
    *   因此，$⟦\alpha \mathbf{2} \beta⟧ = ⟦\alpha' \mathbf{2} \beta'⟧$。

*   **规则 R2 (算子 $\mathbf{1}$ 的同余规则)**: 规则的前提是 $\vdash \alpha \equiv \alpha'$ 和 $\vdash \beta \equiv \beta'$。结论是 $\vdash \alpha \mathbf{1} \beta \equiv \alpha' \mathbf{1} \beta'$。
    *   根据归纳假设，我们有 $⟦\alpha⟧ = ⟦\alpha'⟧$ 和 $⟦\beta⟧ = ⟦\beta'⟧$。
    *   根据算子 $\mathbf{1}$ 的语义定义 (2.3.3):
        $⟦\alpha \mathbf{1} \beta⟧ = (V_\alpha \cap V_\beta, \text{Var}_\alpha \cup \text{Var}_\beta, (V_\alpha \setminus V_\beta) \times (V_\beta \setminus V_\alpha))$
    *   同理，由于 $V_\alpha=V_{\alpha'}, V_\beta=V_{\beta'}$ 等:
        $⟦\alpha' \mathbf{1} \beta'⟧ = (V_{\alpha'} \cap V_{\beta'}, \text{Var}_{\alpha'} \cup \text{Var}_{\beta'}, (V_{\alpha'} \setminus V_{\beta'}) \times (V_{\beta'} \setminus V_{\alpha'})) = ⟦\alpha \mathbf{1} \beta⟧$
    *   因此，$⟦\alpha \mathbf{1} \beta⟧ = ⟦\alpha' \mathbf{1} \beta'⟧$。

*   **规则 R3 (替换规则)**: 规则的前提是 $\vdash \phi \equiv \psi$。结论是 $\vdash \phi\{p \mapsto \delta\} \equiv \psi\{p \mapsto \delta\}$。
    *   根据归纳假设，我们有 $⟦\phi⟧ = ⟦\psi⟧$。
    *   我们需要证明 $⟦\phi\{p \mapsto \delta\}⟧ = ⟦\psi\{p \mapsto \delta\}⟧$。
    *   这正是 **引理 6.1 (语义不变性引理)** 的结论。因此，该规则的可靠性得到保证。

*   **规则 R4 (外延性规则)**: 规则前提是 $\vdash p \mathbf{1} \alpha \equiv p \mathbf{1} \beta$，其中 $p \notin \text{Var}(\alpha) \cup \text{Var}(\beta)$。结论是 $\vdash \alpha \mathbf{1} \alpha \equiv \beta \mathbf{1} \beta$。
    *   假设前提 $\vdash p \mathbf{1} \alpha \equiv p \mathbf{1} \beta$ 是通过一个更短的推演得到的。根据归纳假设，其语义等价成立：$⟦p \mathbf{1} \alpha⟧ = ⟦p \mathbf{1} \beta⟧$。
    *   我们的目标是证明由此可推出结论的语义等价性：$⟦\alpha \mathbf{1} \alpha⟧ = ⟦\beta \mathbf{1} \beta⟧$。
    *   **分析前提的语义**:
        根据定义 2.3.1，我们有 $⟦p⟧ = (\{p\}, \{p\}, \emptyset)$。
        根据定义 2.3.3，我们计算前提等式两端的语义值：
        *   $⟦p \mathbf{1} \alpha⟧ = (V_p \cap V_\alpha, \text{Var}_p \cup \text{Var}_\alpha, (V_p \setminus V_\alpha) \times (V_\alpha \setminus V_p))$
        *   $⟦p \mathbf{1} \beta⟧ = (V_p \cap V_\beta, \text{Var}_p \cup \text{Var}_\beta, (V_p \setminus V_\beta) \times (V_\beta \setminus V_p))$
    *   应用规则的附加条件 $p \notin \text{Var}(\alpha)$ 和 $p \notin \text{Var}(\beta)$，这意味着 $p \notin V_\alpha$ 和 $p \notin V_\beta$。我们简化上述表达式：
        *   $⟦p \mathbf{1} \alpha⟧ = (\{p\} \cap V_\alpha, \{p\} \cup \text{Var}_\alpha, (\{p\} \setminus V_\alpha) \times (V_\alpha \setminus \{p\})) = (\emptyset, \{p\} \cup \text{Var}_\alpha, \{p\} \times V_\alpha)$
        *   $⟦p \mathbf{1} \beta⟧ = (\{p\} \cap V_\beta, \{p\} \cup \text{Var}_\beta, (\{p\} \setminus V_\beta) \times (V_\beta \setminus \{p\})) = (\emptyset, \{p\} \cup \text{Var}_\beta, \{p\} \times V_\beta)$
    *   由于 $⟦p \mathbf{1} \alpha⟧ = ⟦p \mathbf{1} \beta⟧$，它们的三个语义分量必须分别相等：
        1.  **接口变量集**: $\emptyset = \emptyset$。
        2.  **总变量集**: $\{p\} \cup \text{Var}_\alpha = \{p\} \cup \text{Var}_\beta$。因为 $p$ 不属于 $\text{Var}_\alpha$ 或 $\text{Var}_\beta$，此等式蕴含 $\text{Var}_\alpha = \text{Var}_\beta$。
        3.  **链接映射**: $\{p\} \times V_\alpha = \{p\} \times V_\beta$。此等式蕴含 $V_\alpha = V_\beta$。
    *   **分析结论的语义**:
        我们需要证明 $⟦\alpha \mathbf{1} \alpha⟧ = ⟦\beta \mathbf{1} \beta⟧$。
        *   根据定义 2.3.3，$⟦\alpha \mathbf{1} \alpha⟧ = (V_\alpha \cap V_\alpha, \text{Var}_\alpha \cup \text{Var}_\alpha, (V_\alpha \setminus V_\alpha) \times (V_\alpha \setminus V_\alpha)) = (V_\alpha, \text{Var}_\alpha, \emptyset)$。
        *   同理，$⟦\beta \mathbf{1} \beta⟧ = (V_\beta, \text{Var}_\beta, \emptyset)$。
    *   从前提中我们已经推导出 $V_\alpha = V_\beta$ 和 $\text{Var}_\alpha = \text{Var}_\beta$。因此，$⟦\alpha \mathbf{1} \alpha⟧$ 的三个分量 $(V_\alpha, \text{Var}_\alpha, \emptyset)$ 分别等于 $⟦\beta \mathbf{1} \beta⟧$ 的三个分量 $(V_\beta, \text{Var}_\beta, \emptyset)$。
    *   故 $⟦\alpha \mathbf{1} \alpha⟧ = ⟦\beta \mathbf{1} \beta⟧$ 成立。规则可靠。

由于该结论在基础情况下成立，并且对于所有公理模式和推理规则，只要其前提满足归纳假设，其结论也必然满足，故根据对推演长度的数学归纳法原理，可靠性定理对所有可证判断均成立。

**定理 6.2 证毕。**
□



# 广义超图递归模态重写系统 ($\mathcal{H}$-RMRS)

## 1. 结构基础 (Structural Foundation)

**定义 1.1 (计算拓扑)**
系统的拓扑空间定义为一个超图 $\mathcal{H} = (V, \mathcal{E})$：
*   $V$ 为**原子位置 (Atomic Sites)** 的集合。
*   $\mathcal{E} \subseteq 2^V \setminus \{\emptyset\}$ 为**计算环境 (Computing Contexts)** 的集合。
*   关联算子 $\eta: V \to 2^{\mathcal{E}}$ 定义为 $\eta(v) = \{e \in \mathcal{E} \mid v \in e\}$。

**定义 1.2 (本原载荷)**
定义映射 $\rho: V \to \mathcal{P}(\mathcal{T}^2)$，为每个节点分配一个初始的二元关系集（本原规则集）。

---

## 2. 算子族与对称化提升 (Operator Family & Symmetric Lifting)

**定义 2.1 (对称闭包算子)**
对于任意关系 $R \subseteq \mathcal{T}^2$，定义 $\text{Sym}(R) = R \cup R^{-1}$。

**定义 2.2 (全闭包算子)**
定义 $\mathcal{K}: \mathcal{P}(\mathcal{T}^2) \to \mathcal{P}(\mathcal{T}^2)$ 为将关系 $R$ 提升为**同余等价关系**的最小算子：
$$ \mathcal{K}(R) \triangleq \text{Cong}(\text{Sym}(R)) $$
即：包含 $R$ 的满足自反、对称、传递及代数算子封闭性的最小二元关系。

---

## 3. 递归语义构造 (Recursive Semantic Construction)

系统的状态由节点重写向量 $\mathbf{R} = (R_v)_{v \in V}$ 刻画，其中 $R_v \subseteq \mathcal{T}^2$。

**定义 3.1 (环境等式诱导)**
对于任意计算环境（超边）$e \in \mathcal{E}$，该环境在当前状态 $\mathbf{R}$ 下贡献的**等式理论** $E_e^{\mathbf{R}}$ 定义为该环境内所有节点重写能力的提升：
$$ E_e^{\mathbf{R}} \triangleq \mathcal{K} \left( \bigcup_{u \in e} R_u \right) $$

**定义 3.2 (节点模态语境)**
对于节点 $v \in V$，其所处的**递归模态语境** $\sim_v^{\mathbf{R}}$ 定义为其所属所有环境等式理论的并集的传递闭包：
$$ \sim_v^{\mathbf{R}} \triangleq \left( \bigcup_{e \in \eta(v)} E_e^{\mathbf{R}} \right)^* $$

**定义 3.3 (递归转移算子)**
定义系统全局演化算子 $\mathbb{F}: \mathbb{S} \to \mathbb{S}$。对于任意节点 $v$，其分量映射为：
$$ \mathbb{F}(\mathbf{R})_v \triangleq \sim_v^{\mathbf{R}} \circ \rho(v) \circ \sim_v^{\mathbf{R}} $$

---

## 4. 指称与定点语义 (Denotational & Fixed-point Semantics)

**定理 4.1 (单调性与语义存在性)**
算子 $\mathbb{F}$ 在完全格 $(\mathcal{P}(\mathcal{T}^2)^V, \sqsubseteq)$ 上关于逐点包含关系是单调的。根据 Knaster-Tarski 定理，存在最小不动点。

**定义 4.1 (系统的指称语义)**
$\mathcal{H}$-RMRS 的最终重写关系 $\mathbf{R}^\omega$ 定义为：
$$ \mathbf{R}^\omega \triangleq \text{lfp}(\mathbb{F}) $$
这意味着，重写关系与它所模的等式理论是**协同进化**的：重写产生等式，等式反过来定义重写的边界。

---

## 5. 演绎系统与推理规则 (The Inference System)

### A. 重写规则 (Rewriting)
$$
\frac{(l, r) \in \rho(v)}{l \xrightarrow{v} r} \quad \text{(Intrinsic)}
$$
$$
\frac{t \sim_v s \quad s \xrightarrow{v} u \quad u \sim_v w}{t \xrightarrow{v} w} \quad \text{(Modulo-R)}
$$

### B. 等式渗透规则 (Equational Osmosis)
$$
\frac{t \xrightarrow{u} s \quad u \in e}{t \equiv_e s} \quad \text{(Symmetrization)}
$$
$$
\frac{t \equiv_e s \quad v \in e}{t \sim_v s} \quad \text{(Membership)}
$$

### C. 闭包规则 (Closure)
$$
\frac{t \equiv_e s}{s \equiv_e t} \quad \frac{t \equiv_e s \quad s \equiv_e u}{t \equiv_e u} \quad \frac{t_i \equiv_e s_i}{f(\dots t_i \dots) \equiv_e f(\dots s_i \dots)}
$$
$$
\frac{t \sim_v s \quad s \sim_v u}{t \sim_v u}
$$

---


### **分层自反超重图 (Hierarchical Reflexive Hyper-DiGraph) 的形式化定义**

#### **1. 定义**

一个**分层自反超重图 (HRHG)** 是一个六元组 `G = (O, τ, λ, src, tgt, con)`，其构成如下：

*   **1.1. 对象集 (Set of Objects): `O`**
    `O` 是一个集合，称为**对象集**。其元素 `o ∈ O` 是图中的基本实体。

*   **1.2. 类型函数 (Type Function): `τ`**
    `τ` 是一个函数 `τ: O → {V, E, H}`，它为 `O` 中的每一个对象 `o` 指派一个类型：
    *   `V`: **顶点 (Vertex)**
    *   `E`: **有向边 (Directed Edge)**
    *   `H`: **超边 (Hyperedge)**

    基于类型函数 `τ`，我们将 `O` 划分为三个不相交的子集：
    *   顶点集: `O_V = {o ∈ O | τ(o) = V}`
    *   有向边集: `O_E = {o ∈ O | τ(o) = E}`
    *   超边集: `O_H = {o ∈ O | τ(o) = H}`
    使得 `O = O_V ∪ O_E ∪ O_H`，且 `O_V ∩ O_E = ∅`, `O_V ∩ O_H = ∅`, `O_E ∩ O_H = ∅`。

*   **1.3. 层级函数 (Level Function): `λ`**
    `λ` 是一个函数 `λ: O → ℕ` (其中 `ℕ = {0, 1, 2, ...}` 是自然数集)，它为每一个对象 `o` 指派一个唯一的层级。

*   **1.4. 源函数与目标函数 (Source and Target Functions): `src`, `tgt`**
    *   `src` 是一个函数 `src: O_E → O`，它为每一个有向边对象指定其**源对象 (source object)**。
    *   `tgt` 是一个函数 `tgt: O_E → O`，它为每一个有向边对象指定其**目标对象 (target object)**。

*   **1.5. 构成集函数 (Constituent Set Function): `con`**
    `con` 是一个函数 `con: O_H → P(O)` (其中 `P(O)` 是 `O` 的幂集)，它为每一个超边对象指定其**构成对象 (constituent objects)** 的集合。

#### **2. 良定性公理 (Well-formedness Axioms)**

一个元组 `(O, τ, λ, src, tgt, con)` 必须满足以下三条公理，才能成为一个合法的 HRHG：

*   **公理 1 (有向边层级约束):**
    对于任意有向边对象 `e ∈ O_E`，其层级必须严格大于其源对象和目标对象的层级。
    `∀e ∈ O_E, (λ(e) > λ(src(e))) ∧ (λ(e) > λ(tgt(e)))`

*   **公理 2 (超边层级约束):**
    对于任意超边对象 `h ∈ O_H`，其层级必须严格大于其所有构成对象的层级。
    `∀h ∈ O_H, ∀o' ∈ con(h), λ(h) > λ(o')`

*   **公理 3 (基础层级约束):**
    所有层级为 0 的对象必须是顶点。
    `∀o ∈ O, (λ(o) = 0) ⇒ (τ(o) = V)`

#### **3. 派生概念 (Derived Concepts)**

基于上述定义，我们可以形式化地定义一些有用的派生概念：

*   **3.1. 对象的构成集 (Constituents of an Object)**
    我们可以将 `con` 的概念推广到所有非顶点对象。定义函数 `Constituents: O_E ∪ O_H → P(O)` 如下：
    *   若 `o ∈ O_E`，则 `Constituents(o) := {src(o), tgt(o)}`
    *   若 `o ∈ O_H`，则 `Constituents(o) := con(o)`

*   **3.2. 直接构成关系 (Direct Constitution Relation)**
    我们可以在 `O` 上定义一个二元关系 `≺`，称为**直接构成关系**：
    `∀o₁, o₂ ∈ O, o₂ ≺ o₁` 当且仅当 `τ(o₁) ≠ V` 且 `o₂ ∈ Constituents(o₁)`。
    *直观上，`o₂ ≺ o₁` 意为 “`o₂` 是构建 `o₁` 的直接组件”。*
    *由公理 1 和 2 可知，若 `o₂ ≺ o₁`，则 `λ(o₂) < λ(o₁)`。这保证了 `≺` 关系是一个**有向无环图 (DAG)**。*

*   **3.3. 基础顶点 (Base Vertices)**
    一个 HRHG 的**基础顶点集** `V_base` 定义为所有层级为 0 的对象集合：
    `V_base := {o ∈ O | λ(o) = 0}`
    *由公理 3 可知，`V_base ⊆ O_V`。*

---

### **一种分层生成图结构 (A Hierarchically Generated Graph Structure)**

此结构通过一个归纳过程，从一个基础集合和一系列构造规则中生成一个无限的、分层的对象系统。

#### **1. 构造参数 (Construction Parameters)**

一个分层生成图由以下两个参数唯一确定：

1.  **基础集 (Base Set):** 一个非空的可数集合 `B`。
2.  **构造序列 (Construction Sequence):** 一个无穷序列 `σ = ⟨(Hₖ, Eₖ)⟩ₖ≥₁`，其中对于每一个 `k ≥ 1`：
    *   `Hₖ` 是一个集合，称为 **k级超边规定 (Level-k Hyperedge Specification)**。
    *   `Eₖ` 是一个集合，称为 **k级有向边规定 (Level-k Directed Edge Specification)**。

#### **2. 归纳构造过程 (Inductive Construction Process)**

我们通过对层级 `k ∈ ℕ` 进行归纳，定义一系列集合：`Vₖ` (k级顶点集)，`Oₖᴴ` (k级超边对象集)，`Oₖᴱ` (k级有向边对象集)，以及 `Uₖ` (k级图支架节点集)。

*   **基础 (k = 0):**
    *   `V₀ := B`

*   **归纳步骤 (对于 k ≥ 1):**
    假设 `Vₖ₋₁` 已经定义，我们按以下步骤构造第 `k` 层的对象：

    1.  **超边形成 (Hyperedge Formation):**
        *   `k` 级的超边规定 `Hₖ` 必须是 `Vₖ₋₁` 幂集的一个子集，即 `Hₖ ⊆ P(Vₖ₋₁)`.
        *   `k` 级**超边对象集** `Oₖᴴ` 定义为 `Oₖᴴ := Hₖ`。
        *(注：每个 `h ∈ Oₖᴴ` 是一个新对象，其数学本质是一个由 `Vₖ₋₁` 中对象构成的集合。)*

    2.  **图支架形成 (Graph Scaffolding):**
        *   `k` 级**图支架节点集** `Uₖ` 定义为 `Uₖ := Vₖ₋₁ ∪ Oₖᴴ`。

    3.  **有向边形成 (Directed Edge Formation):**
        *   `k` 级的有向边规定 `Eₖ` 必须是 `Uₖ × Uₖ` 的一个子集，即 `Eₖ ⊆ Uₖ × Uₖ`。
        *   `k` 级**有向边对象集** `Oₖᴱ` 定义为 `Oₖᴱ := Eₖ`。
        *(注：每个 `e ∈ Oₖᴱ` 是一个新对象，其数学本质是一个由 `Uₖ` 中对象构成的有序对。)*

    4.  **顶点聚合 (Vertex Aggregation):**
        *   定义一个图 `Gₖ = (Uₖ, Oₖᴱ)`。
        *   `k` 级**顶点集** `Vₖ` 定义为图 `Gₖ` 的**连通分支**的集合。
        *   `Vₖ := C(Gₖ)`，其中 `C(G)` 代表图 `G` 的连通分支的集合。
        *(注：此处的“连通分支”指 `Gₖ` 的底层无向图的连通分支。每个 `v ∈ Vₖ` 是一个新对象，其数学本质是一个由 `Uₖ` 中对象构成的集合。)*

#### **3. 最终的图结构 (The Resulting Graph Structure)**

由参数 `(B, σ)` 生成的图结构是一个六元组 `G = (O, τ, λ, src, tgt, con)`，其定义如下：

*   **1. 对象集 (Set of Objects) `O`:**
    `O := (⋃_{k=0}^{∞} Vₖ) ∪ (⋃_{k=1}^{∞} Oₖᴴ) ∪ (⋃_{k=1}^{∞} Oₖᴱ)`
    *(注：基于标准的集合论表示，`Vₖ` 中的对象（非空集合）、`Oₖᴴ` 中的对象（非空集合）与 `Oₖᴱ` 中的对象（有序对）是互不相交的。`Vₖ` 与 `Oₖᴴ` 的不相交性源于前者是后者的上一层结构的连通分量。为保证严格不相交，可对各类对象加标签。)*

*   **2. 类型函数 (Type Function) `τ: O → {Vertex, Edge, Hyperedge}`:**
    对于任意对象 `o ∈ O`:
    *   若 `o ∈ ⋃ Vₖ`，则 `τ(o) := Vertex`。
    *   若 `o ∈ ⋃ Oₖᴱ`，则 `τ(o) := Edge`。
    *   若 `o ∈ ⋃ Oₖᴴ`，则 `τ(o) := Hyperedge`。

*   **3. 层级函数 (Level Function) `λ: O → ℕ`:**
    对于任意对象 `o ∈ O`:
    *   若 `o ∈ Vₖ`，则 `λ(o) := 2k`。
    *   若 `o ∈ Oₖᴴ`，则 `λ(o) := 2k - 1`。
    *   若 `o ∈ Oₖᴱ`，则 `λ(o) := 2k`。

*   **4. 源函数与目标函数 (Source and Target Functions):**
    *   `src: (⋃ Oₖᴱ) → O`
    *   `tgt: (⋃ Oₖᴱ) → O`
    对于任意 `k ≥ 1` 和任意有向边对象 `e = (o₁, o₂) ∈ Oₖᴱ`：
    *   `src(e) := o₁`
    *   `tgt(e) := o₂`

*   **5. 构成集函数 (Constituent Set Function):**
    *   `con: (⋃ Oₖᴴ) → P(O)`
    对于任意 `k ≥ 1` 和任意超边对象 `h ∈ Oₖᴴ`：
    *   `con(h) := h`
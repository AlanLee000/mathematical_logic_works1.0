# 二叉树雕刻游戏

## 1. 基础架构 (Infrastructure)

### 定义 1.1 (全空间拓扑 $\Omega$)
全空间定义为一个无限无向完全二叉树结构 $\Omega = (V_{\Omega}, E_{\Omega})$。
*   **节点集合** $V_{\Omega} = \{0, 1\}^*$（由0和1构成的有限字符串集合）。
    *   $\lambda$ 表示初始全局根节点（空串）。
    *   对于任意 $u \in V_{\Omega}$，定义其**固有左子节点**为 $u0$，**固有右子节点**为 $u1$。
*   **基础边集** $E_{\Omega}$。
    *   $E_{\Omega} = \{ \{u, u\sigma\} \mid u \in V_{\Omega}, \sigma \in \{0, 1\} \}$。
    *   注意：边是无向的，即 $\{u, v\} = \{v, u\}$。
    *   对于任意 $e \in E_{\Omega}$，其固有类型为 $\tau(e) = \mathbf{T}$ (Tree Edge)。

### 定义 1.2 (配置空间 $\mathbb{S}$)
游戏的任意瞬间状态由二元组 $S_t = (G_t, \rho_t)$ 描述。
1.  **当前图结构** $G_t = (V_{\Omega}, E_t)$：
    *   边集分解：$E_t = E_{T,t} \cup E_{V,t}$。
    *   $E_{T,t} \subseteq E_{\Omega}$ (当前残留的树边)。
    *   $E_{V,t}$ (当前存在的虚边)，满足 $E_{V,t} \cap E_{\Omega} = \emptyset$。
    *   对于任意 $e \in E_{V,t}$，其类型定义为 $\tau(e) = \mathbf{V}$ (Virtual Edge)。
2.  **当前根节点** $\rho_t \in V_{\Omega}$：
    *   作为博弈当前的参照原点。
    *   初始状态 $S_0 = ((V_{\Omega}, E_{\Omega}), \lambda)$。

### 定义 1.3 (同构目标 $G^*$)
给定一个有限、简单、连通的无向图 $G^* = (V^*, E^*)$ 作为胜利目标。

---

## 2. 约束判定系统 (Constraint Resolution System)

### 定义 2.1 (路径属性)
在配置 $G_t$ 中，路径 $P$ 定义为顶点序列 $(v_0, v_1, \dots, v_k)$，满足 $\{v_i, v_{i+1}\} \in E_t$。
令 $e_i = \{v_{i-1}, v_i\}$，定义路径的边类型序列为 $\Sigma_P = (\tau(e_1), \dots, \tau(e_k))$。
由于边的双向性，路径的遍历方向由玩家指定。

#### 2.1.1 密度约束 (Density Constraint)
谓词 $\Phi_{\text{dense}}(P)$ 为真，当且仅当序列 $\Sigma_P$ 中**不包含**子序列 $(\mathbf{V}, \underbrace{\mathbf{T}, \mathbf{T}, \dots, \mathbf{T}}_{n \ge 2}, \mathbf{V})$。
> *语义：任意两条虚边之间，若通过树边连接，其树边数量必须小于 2（即只能间隔 0 或 1 条树边）。*

#### 2.1.2 归根性 (Radicality)
谓词 $\Phi_{\text{root}}(P, \rho_t)$ 为真，当且仅当路径的一个端点为当前根节点，即 $v_0 = \rho_t$ 或 $v_k = \rho_t$。

#### 2.1.3 新生包含性 (Novelty Inclusion)
对于给定的特定边 $e_{new}$，谓词 $\Phi_{\text{inc}}(P, e_{new})$ 为真，当且仅当 $e_{new} \in \{ \{v_i, v_{i+1}\} \}_{i=0}^{k-1}$。

### 定义 2.2 (合法毁灭路径集合 $\mathcal{R}$)
给定当前状态 $S_t$ 和试探性插入的新边 $e_{new}$，构造临时图 $G' = (V_{\Omega}, E_t \cup \{e_{new}\})$。
合法毁灭路径集合定义为：
$$
\mathcal{R}(S_t, e_{new}) = \{ P \subseteq G' \mid \Phi_{\text{root}}(P, \rho_t) \land \Phi_{\text{dense}}(P) \land \Phi_{\text{inc}}(P, e_{new}) \}
$$

---

## 3. 游戏进程与状态转移 (Gameplay & Transitions)

游戏在离散时间 $t$ 进行，每个回合包含三个严格有序的阶段：**构造 (Construction)**、**崩塌 (Collapse)**、**演替 (Succession)**。

### 3.1 第一阶段：构造 (Construction)
玩家在 $V_{\Omega}$ 中选择两个节点 $u, v$，构造候选虚边 $e_{new} = \{u, v\}$。
生成中间边集 $E'_{t} = E_t \cup \{e_{new}\}$。

### 3.2 第二阶段：崩塌 (Collapse)
系统计算集合 $\mathcal{R}(S_t, e_{new})$。

*   **情况 A：稳定 (Stability)**
    若 $\mathcal{R}(S_t, e_{new}) = \emptyset$，则新边保留：
    $$E''_{t} = E'_{t}$$
*   **情况 B：选择性消去 (Selective Erasure)**
    若 $\mathcal{R}(S_t, e_{new}) \neq \emptyset$，**玩家必须**从中选择一条路径 $P^* \in \mathcal{R}(S_t, e_{new})$。
    系统移除路径上的所有边：
    $$E''_{t} = E'_{t} \setminus E(P^*)$$
    *(注：$E(P^*)$ 为路径 $P^*$ 包含的边集，此操作将同时移除 $e_{new}$ 及路径上的其他树边或虚边)*

### 3.3 第三阶段：演替 (Succession)
系统检查当前根节点 $\rho_t$ 的连接状态，决定下一时刻的状态 $S_{t+1} = (G_{t+1}, \rho_{t+1})$。

定义 $\rho_t$ 的**固有子边集**为 $\text{ChildEdges}(\rho_t) = \{ \{\rho_t, \rho_t 0\}, \{\rho_t, \rho_t 1\} \}$。

*   **判定条件**：
    若 $\text{ChildEdges}(\rho_t) \cap E''_{t} = \emptyset$（即根节点的两条固有子树边均已在当前或之前的回合中被消除）：
    
    1.  **玩家行使演替权**：玩家指定一个新的节点 $v_{orphan} \in V_{\Omega}$ 作为新根。
    2.  **孤儿约束**：被选中的 $v_{orphan}$ 必须满足“无父节点”属性，即在当前边集 $E''_{t}$ 中，不存在与其固有父节点连接的边：
        $$ \{v_{orphan}, \text{parent}(v_{orphan})\} \notin E''_{t} $$
        *(对于原点 $\lambda$，此条件天然满足)*
    3.  **状态更新**：
        $$ E_{t+1} = E''_{t}, \quad \rho_{t+1} = v_{orphan} $$

*   **否则 (保留原根)**：
    $$ E_{t+1} = E''_{t}, \quad \rho_{t+1} = \rho_t $$

---

## 4. 胜利条件 (Victory Condition)

定义算子 $\text{Components}(G)$ 为无向图 $G$ 中所有连通分支的集合。
玩家在时刻 $t$ 获胜，当且仅当存在一个连通分支与目标图同构：
$$
\exists C \in \text{Components}(G_t) : C \cong G^*
$$

